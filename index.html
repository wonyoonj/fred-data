<!DOCTYPE html>
<html lang="ko">
<head>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/rss.xml">
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml">

    <script>
        // 웹 브라우저 환경(http:, https:)에서만 광고 스크립트를 동적으로 추가합니다.
        if (window.location.protocol.startsWith('http')) {
            const adsScript = document.createElement('script');
            adsScript.async = true;
            adsScript.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3939948593689554";
            adsScript.crossOrigin = "anonymous";
            document.head.appendChild(adsScript);
        }
    </script>
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">
    <meta name="naver-site-verification" content="3c5e34898f2cef35432619edafb1d9362ab55063" />
    <meta name="google-site-verification" content="_jcjvlFGv3HiGbo85WZ6IU_dfDIQx2j2JH0k5uMHq7U" />
    
    <link rel="alternate" hreflang="ko" href="https://americayoudongsung.netlify.app/" />
    <link rel="alternate" hreflang="en" href="https://americayoudongsung.netlify.app/en/" />
    <link rel="alternate" hreflang="x-default" href="https://americayoudongsung.netlify.app/" />

    <title>원뎅이의 미국 통화 유동성 현황</title>
    <meta name="title" content="원뎅이의 미국 통화 유동성 현황">
    <meta name="subject" content="실시간 지표 데이터를 통해, 현재 미국 시장의 통화 유동성 흐름을 한눈에 파악해보세요!">
    <meta name="description" content="미국의 FED, 정부, MMF, 시장 간의 유동성 흐름을 애니메이션으로 한눈에 시각화하여 보여줍니다.">
    <meta name="keywords" content="미국, FED, 연준, 정부, MMF, 시장, 관세, 유동성, 역레포, 금리, 긴축, 양적완화, TGA잔고, SOFR, EFFR, 국채금리, 나스닥, S&P500, M2, M1, 지금준비금, 실시간, 트럼프, 파월, 베센트">

    <meta property="og:type" content="website">
    <meta property="og:title" content="원뎅이의 미국 통화 유동성 현황">
    <meta property="og:description" content="미국의 FED, 정부, MMF, 시장, 관세 간의 유동성 흐름을 애니메이션으로 한눈에 시각화하여 보여줍니다.">
    <meta property="og:image" content="https://americayoudongsung.netlify.app/icon/government.JPG">
    <meta property="og:url" content="https://americayoudongsung.netlify.app/">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org/",
      "@type": "Dataset",
      "name": "원뎅이의 미국 통화 유동성 데이터",
      "description": "미국 연방준비제도(FED), 재무부(TGA), 머니마켓펀드(MMF), 시장 간의 실시간 유동성 흐름을 시각화하여 제공하는 데이터 웹사이트입니다. TGA 잔고, 역레포, 국채 금리 등 주요 경제 지표를 그래프로 분석할 수 있습니다.",
      "url": "https://americayoudongsung.netlify.app/",
      "keywords": ["미국 유동성", "TGA", "FED", "MMF", "역레포", "양적완화", "양적긴축", "미국 경제지표"],
      "creator": {
        "@type": "Person",
        "name": "원뎅이"
      },
      "license": "https://creativecommons.org/licenses/by/4.0/"
    }
    </script>
    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.1/kakao.min.js"
    integrity="sha384-kDljxUXHaJ9xAb2AzRd59KxjrFjzHa5TAoFQ6GbYTCAG0bjM55XohjjDT7tDDC01" crossorigin="anonymous" defer></script>
    <base target="_top">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* CSS 스타일 코드는 기존과 동일하게 유지됩니다. */
        body { font-family: 'Arial', sans-serif; margin: 0; padding: 0; background: #f4f4f4; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; position: relative; min-height: 100vh; }
        .header { text-align: center; padding: 10px; background: #007bff; color: white; }
        .back-btn { position: absolute; top: 10px; left: 10px; background: none; border: none; cursor: pointer; font-size: 24px; font-weight: bold; color: black; width: 30px; text-align: center; }
        .back-btn::before { content: "◄"; font-size: 36px; }
        .info-btn { position: absolute; top: 10px; right: 10px; background: none; border: none; cursor: pointer; font-size: 20px; }
        .button { padding: 10px 20px; background: #0056b3; color: white; border: none; cursor: pointer; } /* ACCESSIBILITY: Increased contrast */
        .button:hover { background: #004494; }

        .page-title {
            position: absolute;
            top: 10px;
            left: 20px;
            font-size: 35px;
            font-weight: bold;
            color: black;
        }
        
        .source-credit-main {
            position: absolute;
            /*top: 45px;*/
            right: 15px;
            font-size: 12px;
            font-weight: bold;
            color: #555;
        }

        /* ▼▼▼ 언어 선택 버튼 스타일 ▼▼▼ */
        .lang-selector {
            display: flex;
            justify-content: center;
            margin: 10px auto;
            background-color: #e9ecef;
            border-radius: 20px;
            padding: 4px;
            width: fit-content;
        }
        .lang-btn {
            padding: 8px 20px;
            border: none;
            background-color: transparent;
            cursor: pointer;
            border-radius: 16px;
            font-weight: bold;
            transition: background-color 0.3s, color 0.3s;
        }
        .lang-btn.active {
            background-color: #007bff;
            color: white;
        }
        /* ▲▲▲ 언어 선택 버튼 스타일 ▲▲▲ */
        
        /* 소개 및 안내 페이지 스타일 */
        .info-box {
            padding: 20px; 
            text-align: left; 
            max-width: 800px; 
            margin: 20px auto; 
            background-color: #ffffff; 
            border-radius: 8px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            line-height: 1.6;
        }
        .info-box h2 {
            text-align: center;
            color: #0056b3;
        }
        .info-box h3 {
            margin-top: 30px;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 5px;
            color: #0056b3;
        }
        .info-box ul {
            list-style-type: disc;
            padding-left: 20px;
        }
        .info-box li {
            margin-bottom: 10px;
        }
        .info-box strong {
            color: #007bff;
        }
        .info-box .positive { color: rgb(222, 3, 3); font-weight: bold; }
        .info-box .negative { color: #729fff; font-weight: bold; }

        .internal-link {
            cursor: pointer;
            font-weight: bold;
            color: #007bff;
        }
        .internal-link:hover {
            text-decoration: underline;
            color: #0056b3;
        }

        /* --- Animation Wrapper --- */
        .animation-container {
            position: relative;
            width: 100%;
            height: 800px;
            overflow: hidden;
        }

        #liquidityFlow, #interestRateFlow {
            text-align: center;
            padding: 20px;
        }
        #liquidityFlow .icon-container, #interestRateFlow .icon-container {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transform: translate(-50%, -50%);
        }
        #liquidityFlow .icon, #interestRateFlow .icon {
            width: 80px;
            height: 80px;
            display: block;
            object-fit: contain;
        }
        #liquidityFlow .icon-label, #interestRateFlow .icon-label {
            font-weight: bold;
            color: black;
            font-size: 14px;
            white-space: nowrap;
            margin-top: 5px;
        }

        .FED-container .icon-label {
            order: -1;
            margin-bottom: 5px;
            margin-top: 0;
        }

        .FED-container { top: 20%; left: 50%; }
        .Government-container { top: 57%; left: 20%; }
        .Market-container { top: 90%; left: 50%; }
        .MMF-container { top: 57%; left: 80%; }

        #tgaSlopeDisplay, #fedLiquidityDisplay, #mmfToRrpDisplay, #mmfToMarketDisplay,
        #tb3msRateDisplay_interest, #rrpRateDisplay_interest, #effrRateDisplay_interest, #sofrRateDisplay_interest,
        #tb1yrRateDisplay_interest, #discountRateDisplay_interest, #tb10yrRateDisplay_interest,
        #sofrEffrSpreadDisplay_interest {
            position: absolute;
            transform: translateX(-50%);
            font-size: 0.85em; 
            font-weight: bold;
            z-index: 10;
            background: rgba(255, 255, 255, 0.8);
            padding: 3px 6px;
            border-radius: 5px;
            border: 1px solid #ccc;
            text-align: center;
        }
        
        #netMarketFlowDisplay, #netMarketFlowDisplay_interest {
            display: inline-block;
            top: -40%;
            left: 50%;
            background: none;
            border: none;
            font-size: 0.9em;
            min-width: 200px;
        }

        .popup-container {
            position: absolute;
            z-index: 20;
        }

        .popup-container:hover {
            z-index: 30;
        }
        
        .tga-popup-container { top: calc(60% + 40px + 5px); left: 30%; transform: translateX(-50%); }
        .tga-popup-container-1yr { top: calc(60% + 40px + 5px + 50px); left: 30%; transform: translateX(-50%); }
        .tga-popup-container-10yr { top: calc(60% + 40px + 5px + 100px); left: 30%; transform: translateX(-50%); }
        .fed-popup-container { top: calc(38% - 40px - 10px); left: 45%; transform: translateX(-50%); }
        .fed-popup-container-discount { top: calc(38% - 40px - 10px); left: 70%; transform: translateX(-50%); }
        .mmf-fed-popup-container { top: calc(50% - 40px - 10px); left: 80%; transform: translateX(-50%); }
        .mmf-market-popup-container { top: calc(63% + 40px); left: 80%; transform: translateX(-50%); }
        
        .sofr-effr-popup-container { top: 57%; left: 70%; transform: translateX(-50%); }

        .tooltip-container {
            visibility: hidden;
            background-color: #555;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 9999;
            bottom: 100%;
            left: 50%;
            margin-left: -100px;
            width: 180px;
            opacity: 0;
            transition: opacity 0.3s;
            line-height: 1.5;
            white-space: normal;
        }
        
        .fed-popup-container .tooltip-container,
        .fed-popup-container-discount .tooltip-container,
        .mmf-fed-popup-container .tooltip-container {
            bottom: auto;
            top: 100%;
            margin-top: 10px;
        }

        .tooltip-container p {
            margin-top: 0;
            margin-bottom: 5px;
            font-size: 13px;
            font-weight: normal;
        }

        .tooltip-container .graph-btn {
            background: #009688;
            color: white;
            border: none;
            padding: 5px 10px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 12px;
            margin-top: 10px;
            cursor: pointer;
            border-radius: 3px;
        }

        .tooltip-container .update-date {
            font-size: 10px;
            color: #ccc;
            text-align: right;
            margin-top: 10px;
            display: block;
        }
        
        .tooltip-container::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #555 transparent transparent transparent;
        }
        
        .fed-popup-container .tooltip-container::after,
        .fed-popup-container-discount .tooltip-container::after,
        .mmf-fed-popup-container .tooltip-container::after {
            top: auto;
            bottom: 100%;
            border-color: transparent transparent #555 transparent;
        }

        .liquidity-tga-popup:hover .tooltip-container { margin-left: -150px; }
        .liquidity-fed-popup:hover .tooltip-container { margin-left: -150px; top: 25px; width: 250px; }
        .liquidity-mmf-fed-popup:hover .tooltip-container { margin-left: -220px; top: 25px; width: 250px; }
        .liquidity-mmf-market-popup:hover .tooltip-container { margin-left: -220px; width: 280px; }
        .interest-tb3ms-popup:hover .tooltip-container { margin-left: -150px; }
        .interest-tb1yr-popup:hover .tooltip-container { margin-left: -150px; }
        .interest-tb10yr-popup:hover .tooltip-container { margin-left: -150px; }
        .interest-rrp-rate-popup:hover .tooltip-container { margin-left: -200px; top: 25px; width: 250px; }
        .interest-discount-rate-popup:hover .tooltip-container { margin-left: -200px; top: 25px; width: 250px; }
        .interest-effr-rate-popup:hover .tooltip-container { margin-left: -200px; top: 25px; width: 250px; }
        .interest-sofr-rate-popup:hover .tooltip-container { margin-left: -200px; width: 280px; }
        .sofr-effr-popup-container:hover .tooltip-container { margin-left: -220px; width: 280px; }
        
        .popup-container:hover .tooltip-container {
            visibility: visible;
            opacity: 1;
        }

        #tgaSlopeDisplay, #fedLiquidityDisplay, #mmfToRrpDisplay, #mmfToMarketDisplay,
        #tb3msRateDisplay_interest, #rrpRateDisplay_interest, #effrRateDisplay_interest, #sofrRateDisplay_interest,
        #tb1yrRateDisplay_interest, #discountRateDisplay_interest, #tb10yrRateDisplay_interest,
        #sofrEffrSpreadDisplay_interest {
            position: relative;
            z-index: 10;
            cursor: help;
        }
        
        .slope-positive { color: rgb(222, 3, 3); }
        .slope-negative { color: #729fff; }

        .dollar-animated-object {
            position: absolute;
            object-fit: contain;
            opacity: 0;
            z-index: 5;
        }
        .update-date-span {
            font-size: 66%;
            font-weight: normal;
            color: #555;
            margin-left: 10px;
            vertical-align: middle;
        }
        .share-buttons-container {
            display: flex;
            justify-content: flex-end; /* PC: 오른쪽 정렬 */
            align-items: center;
            gap: 10px;
            padding: 15px 0;
            max-width: 800px;
            margin: 0 auto;
        }
        .share-button {
            display: inline-block;
            padding: 6px 9px; /* 8px 12px -> 6px 9px */
            border-radius: 5px;
            color: white;
            text-decoration: none;
            font-weight: bold;
            font-size: 11px; /* 14px -> 11px */
            cursor: pointer;
            transition: opacity 0.2s;
        }
        .share-button:hover {
            opacity: 0.8;
        }
        .share-button.twitter { background-color: #1DA1F2; }
        .share-button.facebook { background-color: #1877F2; }
        .share-button.kakao { background-color: #FEE500; color: #191919; }
        .share-button.line { background-color: #00C300; }
        .share-button.copy-link { background-color: #6c757d; }


        @keyframes dollarFlowToMarket {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 20%; }
            20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 20%; }
            80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 90%; }
            100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 90%; }
        }
        @keyframes dollarFlowToFED {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 90%; }
            20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 90%; }
            80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 20%; }
            100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 20%; }
        }
        @keyframes dollarFlowToGovernment {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 90%; }
            20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 90%; }
            80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 20%; top: 57%; }
            100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 20%; top: 57%; }
        }
        @keyframes dollarFlowFromGovernment {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 20%; top: 57%; }
            20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 20%; top: 57%; }
            80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 90%; }
            100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 90%; }
        }
        @keyframes dollarFlowFromMmfToFed {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 80%; top: 57%; }
            20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 80%; top: 57%; }
            80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 20%; }
            100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 20%; }
        }
        @keyframes dollarFlowFromFedToMmf {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 20%; }
            20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 20%; }
            80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 80%; top: 57%; }
            100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 80%; top: 57%; }
        }
        @keyframes dollarFlowFromMmfToMarket_parabolic {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 80%; top: 57%; }
            20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 80%; top: 57%; }
            50% { transform: translate(-50%, -50%) scale(1) translateY(50px); opacity: 1; left: 65%; top: 75%; }
            80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 90%; }
            100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 90%; }
        }
        @keyframes dollarFlowFromMarketToMmf_parabolic {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 90%; }
            20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 90%; }
            50% { transform: translate(-50%, -50%) scale(1) translateY(50px); opacity: 1; left: 65%; top: 75%; }
            80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 80%; top: 57%; }
            100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 80%; top: 57%; }
        }
        @keyframes dollarFlowFromMmfToGovernment {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 80%; top: 57%; }
            20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 80%; top: 57%; }
            80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 20%; top: 57%; }
            100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 20%; top: 57%; }
        }
        @keyframes dollarFlowFromGovernmentToMmf {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 20%; top: 57%; }
            20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 20%; top: 57%; }
            80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 80%; top: 57%; }
            100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 80%; top: 57%; }
        }

        .animated-dollar-to-market { animation: dollarFlowToMarket var(--animation-duration) linear forwards; }
        .animated-dollar-to-fed { animation: dollarFlowToFED var(--animation-duration) linear forwards; }
        .animated-dollar-to-government { animation: dollarFlowToGovernment var(--animation-duration) linear forwards; }
        .animated-dollar-from-government { animation: dollarFlowFromGovernment var(--animation-duration) linear forwards; }
        .animated-dollar-from-mmf-to-fed { animation: dollarFlowFromMmfToFed var(--animation-duration) linear forwards; }
        .animated-dollar-from-fed-to-mmf { animation: dollarFlowFromFedToMmf var(--animation-duration) linear forwards; }
        .animated-dollar-from-mmf-to-market_parabolic { animation: dollarFlowFromMmfToMarket_parabolic var(--animation-duration) linear forwards; }
        .animated-dollar-from-market-to-mmf_parabolic { animation: dollarFlowFromMarketToMmf_parabolic var(--animation-duration) linear forwards; }

        #graphIndicators { padding: 20px; text-align: center; }
        .indicator-section { margin-bottom: 20px; background-color: #ffffff; padding: 15px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .indicator-section h3 { font-size: 18px; margin-top: 0; margin-bottom: 10px; color: #007bff; }
        .indicator-section p { font-size: 14px; color: #666; margin-top: 0; margin-bottom: 15px; }
        .indicator-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 600px;
            margin: 0 auto;
        }

        #graphPage {
            text-align: center;
            padding: 20px;
            height: 500px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
        }
        #graphPage canvas {
            max-width: 100%;
            width: 100%;
            height: 400px;
            cursor: grab;
            flex-grow: 1;
        }

        #graphDataSource {
            position: absolute;
            top: 70px;
            right: 25px;
            font-size: 12px;
            color: #666;
            background-color: rgba(240, 240, 240, 0.8);
            padding: 2px 5px;
            border-radius: 3px;
            z-index: 10;
        }

        #infoPage { padding: 20px; text-align: left; }
        #infoContent h3 {
            color: #007bff;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
            margin-top: 25px;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        #infoContent p {
            line-height: 1.7;
            text-align: justify;
        }

        .time-buttons { margin: 10px 0; display: flex; justify-content: center; gap: 5px; flex-wrap: wrap; }
        .time-btn { padding: 5px 10px; background: #e9ecef; border: 1px solid #ced4da; border-radius: 5px; cursor: pointer; font-size: 0.9em; transition: background-color 0.2s; }
        .time-btn:hover { background-color: #dee2e6; }
        .nav-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: #0056b3; padding: 10px; display: flex; justify-content: space-around; z-index: 1000; }

        @media (max-width: 600px) {
            .container { padding: 10px 5px; } 
            .back-btn { top: 5px; left: 5px; }
            .info-btn { top: 5px; right: 5px; }
            .page-title {
                font-size: 24px;
                top: 5px;
                left: 10px;
            }
            .source-credit-main {
                /*top: 55px;*/
                right: 10px;
                font-size: 10px;
            }
            .animation-container {
                height: 550px;
            }

            #liquidityFlow .icon, #interestRateFlow .icon { width: 60px; height: 60px; }
            #liquidityFlow .icon-label, #interestRateFlow .icon-label { font-size: 12px; }

            .FED-container { top: 15%; left: 50%; }
            .Government-container { top: 47%; left: 15%; }
            .Market-container { top: 80%; left: 50%; }
            .MMF-container { top: 47%; left: 83%; }

            #netMarketFlowDisplay, #netMarketFlowDisplay_interest {
                top: -45%;
                min-width: 150px;
            }
            
            #tgaSlopeDisplay, #fedLiquidityDisplay, #mmfToRrpDisplay, #mmfToMarketDisplay,
            #tb3msRateDisplay_interest, #rrpRateDisplay_interest, #effrRateDisplay_interest, #sofrRateDisplay_interest,
            #tb1yrRateDisplay_interest, #discountRateDisplay_interest, #tb10yrRateDisplay_interest,
            #sofrEffrSpreadDisplay_interest {
                font-size: 0.7em;
                padding: 2px 4px;
                white-space: normal;
            }
            
            #mmfToRrpDisplay, #mmfToMarketDisplay,
            #effrRateDisplay_interest, #sofrRateDisplay_interest,
            #sofrEffrSpreadDisplay_interest {
                width: 90px;
            }
            
            .tga-popup-container { top: calc(47% + 30px + 12px); left: 35%; }
            .tga-popup-container-1yr { top: calc(47% + 30px + 12px + 45px); left: 35%; }
            .tga-popup-container-10yr { top: calc(47% + 30px + 12px + 90px); left: 35%; }
            .fed-popup-container { top: calc(28% - 30px - 5px); left: 42%; }
            .fed-popup-container-discount { top: calc(28% - 30px - 5px); left: 65%; }
            .mmf-fed-popup-container { top: calc(32%); left: 83%; }
            .mmf-market-popup-container { top: calc(55%); left: 83%; }

            .sofr-effr-popup-container { top: 45%; left: 70%; }

            .tooltip-container { margin-left: -100px; width: 200px; }
            .liquidity-tga-popup:hover .tooltip-container { width: 200px; left: 30%; margin-left: -70px; }
            .liquidity-fed-popup:hover .tooltip-container { width: 250px; }
            .liquidity-mmf-fed-popup:hover .tooltip-container { width: 200px; }
            .liquidity-mmf-market-popup:hover .tooltip-container { width: 300px; margin-left: -270px;}
            .interest-tb3ms-popup:hover .tooltip-container { width: 200px; left: 30%; margin-left: -70px; }
            .interest-tb1yr-popup:hover .tooltip-container { width: 200px; left: 30%; margin-left: -70px; }
            .interest-tb10yr-popup:hover .tooltip-container { width: 200px; left: 30%; margin-left: -70px; }
            .interest-rrp-rate-popup:hover .tooltip-container { width: 200px; left: 30%; margin-left: -100px; }
            .interest-discount-rate-popup:hover .tooltip-container { width: 250px; }
            .interest-effr-rate-popup:hover .tooltip-container { width: 200px; }
            .interest-sofr-rate-popup:hover .tooltip-container { width: 200px; }
            .sofr-effr-popup-container:hover .tooltip-container { width: 250px; margin-left: -200px; }
            
            .dollar-animated-object { width: 22.5px; height: 22.5px; }
            .share-buttons-container {
                justify-content: center; /* 모바일: 가운데 정렬 */
            }
            @keyframes dollarFlowToMarket {
                0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 15%; }
                20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 15%; }
                80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 80%; }
                100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 80%; }
            }
            @keyframes dollarFlowToFED {
                0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 80%; }
                20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 80%; }
                80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 15%; }
                100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 15%; }
            }
            @keyframes dollarFlowToGovernment {
                0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 80%; }
                20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 80%; }
                80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 15%; top: 47%; }
                100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 15%; top: 47%; }
            }
            @keyframes dollarFlowFromGovernment {
                0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 15%; top: 47%; }
                20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 15%; top: 47%; }
                80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 80%; }
                100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 80%; }
            }
            @keyframes dollarFlowFromMmfToFed {
                0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 83%; top: 47%; }
                20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 83%; top: 47%; }
                80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 15%; }
                100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 15%; }
            }
            @keyframes dollarFlowFromFedToMmf {
                0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 15%; }
                20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 15%; }
                80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 83%; top: 47%; }
                100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 83%; top: 47%; }
            }
            @keyframes dollarFlowFromMmfToMarket_parabolic {
                0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 83%; top: 47%; }
                20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 83%; top: 47%; }
                50% { transform: translate(-50%, -50%) scale(1) translateY(25px); opacity: 1; left: 66.5%; top: 68%; }
                80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 80%; }
                100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 80%; }
            }
            @keyframes dollarFlowFromMarketToMmf_parabolic {
                0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 50%; top: 80%; }
                20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 50%; top: 80%; }
                50% { transform: translate(-50%, -50%) scale(1) translateY(25px); opacity: 1; left: 66.5%; top: 68%; }
                80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 83%; top: 47%; }
                100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 83%; top: 47%; }
            }
            @keyframes dollarFlowFromMmfToGovernment {
                0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 83%; top: 47%; }
                20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 83%; top: 47%; }
                80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 15%; top: 47%; }
                100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 15%; top: 47%; }
            }
            @keyframes dollarFlowFromGovernmentToMmf {
                0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 15%; top: 47%; }
                20% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 15%; top: 47%; }
                80% { transform: translate(-50%, -50%) scale(1); opacity: 1; left: 80%; top: 57%; }
                100% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; left: 80%; top: 57%; }
            }

            .indicator-buttons {
                grid-template-columns: repeat(2, 1fr);
                gap: 5px;
                max-width: 100%;
            }
            .indicator-buttons .button {
                border: 1px solid black;
                width: 95%;
                margin: 5px auto;
            }

            .button { margin: 5px 0; }
            .time-buttons { justify-content: space-around; }
            .time-btn {
                padding: 5px 8px;
                font-size: 0.85em;
                margin: 2px;
                flex-basis: auto;
                width: auto;
            }
            #graphPage canvas {
                width: 100%;
                height: 300px;
            }
            #graphDataSource {
                top: 65px;
                right: 15px;
                font-size: 10px;
            }
            .nav-bar { padding: 5px; }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns" defer></script>
</head>
<body>
    <div class="container">
        
        <div id="liquidityFlow" class="page">
            <h1 class="page-title">원뎅이의 미국 통화 유동성 현황</h1>
            
            <div style="margin-top: 80px;">
                <div class="lang-selector">
                    <button class="lang-btn active">한국어</button>
                    <button class="lang-btn" onclick="window.location.href='/en/'">English</button>
                </div>
            </div>

            <div class="info-box">
                <h2>미국 통화 유동성을 한눈에 파악하세요!</h2>
                <p>
                    '원뎅이의 미국 통화 유동성 현황'에 오신 것을 환영합니다. 본 웹사이트는 투자자와 경제에 관심 있는 모든 분들을 위해 미국 시장의 복잡한 통화 유동성 흐름을 실시간 데이터 기반의 애니메이션으로 시각화하여 제공합니다.
                </p>
                <p>
                    미국 연방준비제도(FED), 정부(TGA), 머니마켓펀드(MMF), 그리고 시장 사이에서 돈이 어떻게 흐르는지 직관적으로 이해함으로써, 금리 변동, 양적완화 및 긴축 정책의 영향을 보다 쉽게 파악하고 현명한 투자 결정을 내리는 데 도움을 드리고자 합니다.
                </p>
                <h3>주요 기능 안내</h3>
                <ul>
                    <li><strong>실시간 유동성 흐름:</strong> 각 경제 주체(정부, 중앙은행, MMF, 시장) 간의 월별 자금 이동 규모를 애니메이션으로 시각화하여 돈의 흐름을 쉽게 추적할 수 있습니다.</li>
                    <li><strong>핵심 금리 현황:</strong> SOFR, EFFR, 국채 금리 등 시장의 중요한 금리 지표들을 실시간으로 확인하고 그 의미를 파악할 수 있습니다.</li>
                    <li><strong>상세 데이터 그래프:</strong> TGA 잔고, M2 통화량, S&P500 지수 등 30여 개의 주요 경제 지표를 기간별 상세 그래프로 직접 분석할 수 있습니다. 각 지표에 대한 설명(Info)도 제공합니다.</li>
                </ul>
                <p style="margin-top: 20px; text-align: center; font-weight: bold;">
                    이제 아래의 시각화 자료를 통해 복잡한 경제의 흐름을 쉽게 탐색해 보세요.
                </p>
                <p style="text-align: center;">
                    (마우스를 갖다대면, 지표 설명이 보여요!)
                </p>
            </div>

            <h3 id="ai-analysis-title-liquidity" style="text-align: center; color: black;"></h3>
            
            <div id="liquidity-analysis-container" class="info-box" style="text-align: left; font-weight: bold; border: 2px solid #007bff; padding: 15px; margin-top: 0;">
                </div>
            
            <div class="share-buttons-container">
                <a class="share-button twitter" onclick="shareOn('twitter')">Twitter</a>
                <a class="share-button facebook" onclick="shareOn('facebook')">Facebook</a>
                <a class="share-button kakao" onclick="shareOn('kakao')">Kakao</a>
                <a class="share-button line" onclick="shareOn('line')">LINE</a>
                <a class="share-button copy-link" onclick="copyLink()">링크 복사</a>
            </div>
            <div class="animation-container">
                <div class="tga-popup-container popup-container liquidity-tga-popup">
                    <div id="tgaSlopeDisplay"></div>
                    <div class="tooltip-container" id="tga-tooltip-content">
                    </div>
                </div>
                
                <div class="fed-popup-container popup-container liquidity-fed-popup">
                    <div id="fedLiquidityDisplay"></div>
                    <div class="tooltip-container" id="fed-tooltip-content">
                    </div>
                </div>

                <div class="mmf-fed-popup-container popup-container liquidity-mmf-fed-popup">
                    <div id="mmfToRrpDisplay"></div>
                    <div class="tooltip-container" id="mmf-fed-tooltip-content">
                    </div>
                </div>

                <div class="mmf-market-popup-container popup-container liquidity-mmf-market-popup">
                    <div id="mmfToMarketDisplay"></div>
                    <div class="tooltip-container" id="mmf-market-tooltip-content">
                    </div>
                </div>
                
                <div class="icon-container FED-container">
                    <span class="icon-label">중앙은행 FED</span>
                    <img src="./icon/fed.jpg" alt="FED" class="icon">
                </div>
                <div class="icon-container Government-container">
                    <img src="./icon/government.JPG" alt="Government TGA" class="icon">
                    <span class="icon-label">미국 정부</span>
                </div>
                <div class="icon-container Market-container">
                    <img src="./icon/Market.jpg" alt="Market" class="icon">
                    <span class="icon-label">미국 시장(Market)</span>
                    <div id="netMarketFlowDisplay"></div>
                    </div>
                <div class="icon-container MMF-container">
                    <img src="./icon/MMF.jpg" alt="MMF" class="icon">
                    <span class="icon-label">MMF<br>(Money Market Fund)</span>
                </div>
            </div>

            <div class="source-credit-main">자료 출처: FRED, Office of Financial Research (OFR)</div>

            <div class="info-box">
                <h3>데이터는 어떻게 해석해야 하나요?</h3>
                <p>메인 페이지의 애니메이션은 각 주체 간의 '최근 한 달간 자금 흐름 변화량'을 나타냅니다. 숫자의 의미는 다음과 같습니다.</p>
                <ul>
                    <li><span class="internal-link" onclick="showGraph('WTREGEN')"><strong>(정부의) TGA 잔고</strong></span> (<span class="negative">- 음수</span>): 정부가 국채 발행 감소나 재정 지출 확대를 통해 시장에 돈을 풀고 있다는 의미입니다. (유동성 공급)</li>
                    <li><span class="internal-link" onclick="showGraph('WTREGEN')"><strong>(정부의) TGA 잔고</strong></span> (<span class="positive">+ 양수</span>): 정부가 세금을 많이 걷거나 국채 발행을 늘려 시장의 돈을 흡수하고 있다는 의미입니다. (유동성 흡수)</li>
                    <br>
                    <li><span class="internal-link" onclick="showGraph('WALCL')"><strong>연준(FED) 유동성</strong></span> (<span class="negative">- 음수</span>): 연준이 양적긴축(자산 매각) 등을 통해 시장의 돈을 거둬들이고 있다는 의미입니다. 혹은 금융기관들이 연준에 역레포 자금을 맡기면서 유동성의 흡수를 의미합니다. (유동성 흡수)</li>
                    <li><span class="internal-link" onclick="showGraph('WALCL')"><strong>연준(FED) 유동성</strong></span> (<span class="positive">+ 양수</span>): 연준이 양적완화(자산 매입) 등을 통해 시장에 돈을 공급하고 있다는 의미입니다. 혹은 금융기관들이 연준에 맡겨뒀던 역레포 자금을 시장으로 돌리고 있다는 의미입니다. (유동성 공급)</li>
                    <br>
                    <li><span class="internal-link" onclick="showGraph('RRPONTSYD')"><strong>MMF → FED</strong></span> (<span class="positive">+ 양수</span>): MMF가 연준의 역레포(RRP)를 통해 자금을 예치하여 시중 유동성이 흡수됨을 의미합니다.</li>
                    <li><span class="internal-link" onclick="showGraph('RRPONTSYD')"><strong>MMF → FED</strong></span> (<span class="negative">- 음수</span>): MMF가 연준에 예치했던 역레포 자금을 회수하여 시중 유동성이 공급됨을 의미합니다.</li>
                    <br>
                    <li><span class="internal-link" onclick="showGraph('MMMFFAQ027S')"><strong>MMF → 시장</strong></span> (<span class="positive">+ 양수</span>): MMF가 국채, 회사채 등 시장의 자산을 매입하여 시장에 유동성을 공급하고 있음을 의미합니다.</li>
                    <li><span class="internal-link" onclick="showGraph('MMMFFAQ027S')"><strong>MMF → 시장</strong></span> (<span class="negative">- 음수</span>): 시장 참여자들이 MMF 펀드에 투자하여 시중 유동성이 MMF로 흡수되고 있음을 의미합니다.</li>
                    </ul>
                <p>결론적으로, <span style="font-weight: bold;">'시장(Market)'으로 들어오는 돈의 총합(Net Market Flow)</span>이 <span class="negative">파란색 음수(-)</span>이면 <span style="font-weight: bold;">시장 유동성이 줄어드는 것</span>으로, <span class="positive">빨간색 양수(+)</span>이면 <span style="font-weight: bold;">유동성이 풍부해지는 것</span>으로 해석할 수 있습니다.</p>
            </div>
            </div>

        <div id="interestRateFlow" class="page" style="display:none;">
            <div class="page-title">원뎅이의 미국 통화 유동성 현황</div>
            
            <div style="margin-top: 80px;">
                <div class="lang-selector">
                    <button class="lang-btn active">한국어</button>
                    <button class="lang-btn" onclick="window.location.href='/en/'">English</button>
                </div>
            </div>

            <div class="info-box">
                <h2>미국 통화 유동성을 한눈에 파악하세요!</h2>
                <h3>주요 기능 안내</h3>
                <ul>
                    <li><strong>실시간 유동성 흐름:</strong> 각 경제 주체(정부, 중앙은행, MMF, 시장) 간의 월별 자금 이동 규모를 애니메이션으로 시각화하여 돈의 흐름을 쉽게 추적할 수 있습니다.</li>
                    <li><strong>핵심 금리 현황:</strong> SOFR, EFFR, 국채 금리 등 시장의 중요한 금리 지표들을 실시간으로 확인하고 그 의미를 파악할 수 있습니다.</li>
                    <li><strong>상세 데이터 그래프:</strong> TGA 잔고, M2 통화량, S&P500 지수 등 30여 개의 주요 경제 지표를 기간별 상세 그래프로 직접 분석할 수 있습니다. 각 지표에 대한 설명(Info)도 제공합니다.</li>
                </ul>
                <p style="margin-top: 20px; text-align: center; font-weight: bold;">
                    이제 아래의 시각화 자료를 통해 복잡한 경제의 흐름을 쉽게 탐색해 보세요.
                </p>
                <p style="text-align: center;">
                    (마우스를 갖다대면, 지표 설명이 보여요!)
                </p>
            </div>

            <h3 id="ai-analysis-title-interest" style="text-align: center; color: black;"></h3>

            <div id="interest-rate-analysis-container" class="info-box" style="text-align: left; font-weight: bold; border: 2px solid #007bff; padding: 15px; margin-top: 0;">
                </div>
            
            <div class="share-buttons-container">
                <a class="share-button twitter" onclick="shareOn('twitter')">Twitter</a>
                <a class="share-button facebook" onclick="shareOn('facebook')">Facebook</a>
                <a class="share-button kakao" onclick="shareOn('kakao')">Kakao</a>
                <a class="share-button line" onclick="shareOn('line')">LINE</a>
                <a class="share-button copy-link" onclick="copyLink()">링크 복사</a>
            </div>
            <div class="animation-container">
                <div class="tga-popup-container popup-container interest-tb3ms-popup">
                    <div id="tb3msRateDisplay_interest"></div>
                    <div class="tooltip-container" id="tb3ms-tooltip-content_interest"></div>
                </div>
                
                <div class="tga-popup-container-1yr popup-container interest-tb1yr-popup">
                    <div id="tb1yrRateDisplay_interest"></div>
                    <div class="tooltip-container" id="tb1yr-tooltip-content_interest"></div>
                </div>

                <div class="tga-popup-container-10yr popup-container interest-tb10yr-popup">
                    <div id="tb10yrRateDisplay_interest"></div>
                    <div class="tooltip-container" id="tb10yr-tooltip-content_interest"></div>
                </div>
                
                <div class="fed-popup-container popup-container interest-rrp-rate-popup">
                    <div id="rrpRateDisplay_interest"></div>
                    <div class="tooltip-container" id="rrp-rate-tooltip-content_interest"></div>
                </div>

                <div class="fed-popup-container-discount popup-container interest-discount-rate-popup">
                    <div id="discountRateDisplay_interest"></div>
                    <div class="tooltip-container" id="discount-rate-tooltip-content_interest"></div>
                </div>

                <div class="mmf-fed-popup-container popup-container interest-effr-rate-popup">
                    <div id="effrRateDisplay_interest"></div>
                    <div class="tooltip-container" id="effr-rate-tooltip-content_interest"></div>
                </div>

                <div class="mmf-market-popup-container popup-container interest-sofr-rate-popup">
                    <div id="sofrRateDisplay_interest"></div>
                    <div class="tooltip-container" id="sofr-rate-tooltip-content_interest"></div>
                </div>

                <div class="sofr-effr-popup-container popup-container">
                    <div id="sofrEffrSpreadDisplay_interest"></div>
                    <div class="tooltip-container" id="sofr-effr-spread-tooltip-content_interest"></div>
                </div>
                <div class="icon-container FED-container">
                    <span class="icon-label">중앙은행 FED</span>
                    <img src="../icon/fed.jpg" alt="FED" class="icon">
                </div>
                <div class="icon-container Government-container">
                    <img src="../icon/government.JPG" alt="Government TGA" class="icon">
                    <span class="icon-label">미국 정부</span>
                </div>
                <div class="icon-container Market-container">
                    <img src="../icon/Market.jpg" alt="Market" class="icon">
                    <span class="icon-label">미국 시장(Market)</span>
                    <div id="netMarketFlowDisplay_interest"></div>
                    </div>
                <div class="icon-container MMF-container">
                    <img src="../icon/MMF.jpg" alt="MMF" class="icon">
                    <span class="icon-label">시중은행(Bank)</span>
                </div>
            </div>

            <div class="source-credit-main">자료 출처: FRED</div>

            <div class="info-box">
                <h3>주요 금리 지표 안내</h3>
                <ul>
                    <li><span class="internal-link" onclick="showGraph('RRPONTSYAWARD')"><strong>역레포 금리</strong></span>: 연준이 금융기관으로부터 자금을 빌릴 때 지급하는 금리로, 시중 유동성을 흡수하는 기준이 됩니다.</li>
                    <li><span class="internal-link" onclick="showGraph('DPCREDIT')"><strong>연준 할인율</strong></span>: 연준이 상업 은행에 대출해 줄 때 적용하는 이자율로, 금융기관의 자금 조달 비용을 결정합니다.</li>
                    <li><span class="internal-link" onclick="showGraph('FEDFUNDS')"><strong>EFFR 금리</strong></span>: 은행 간에 자금을 빌릴 때 적용되는 실제 금리로, 연준의 통화 정책 방향성을 보여줍니다.</li>
                    <li><span class="internal-link" onclick="showGraph('SOFR')"><strong>SOFR 금리</strong></span>: 국채를 담보로 한 초단기 대출 금리로, 단기 자금 시장의 유동성 상황을 직접적으로 반영합니다.</li>
                    <li><span class="internal-link" onclick="showGraph('DGS3MO')"><strong>3개월 미 국채금리</strong></span>: 3개월 만기 국채 수익률로, 단기 시장 금리와 인플레이션 기대치를 나타냅니다.</li>
                    <li><span class="internal-link" onclick="showGraph('DGS2')"><strong>2년물 미 국채금리</strong></span>: 2년 만기 국채 수익률로, 중단기 경제 전망을 반영합니다.</li>
                    <li><span class="internal-link" onclick="showGraph('DGS10')"><strong>10년물 미 국채금리</strong></span>: 10년 만기 국채 수익률로, 장기 경제 성장과 인플레이션에 대한 시장의 기대를 보여주는 핵심 지표입니다.</li>
                    <li><span class="internal-link" onclick="showGraph('SOFR_FEDFUNDS_SPREAD')"><strong>SOFR EFFR 스프레드</strong></span>: 담보(SOFR)와 무담보(EFFR) 단기 대출 금리 차이로, 시장의 유동성 및 신용 위험 상태를 나타냅니다. 스프레드 확대는 유동성 긴축 신호일 수 있습니다.</li>
                    <li><span class="internal-link" onclick="showGraph('YIELD_SPREAD')"><strong>미국 장단기 금리차</strong></span>: 경기 침체의 선행 지표로, 장기 금리가 단기 금리보다 낮아지는 역전 현상이 발생하면 향후 경기 둔화 가능성을 시사합니다.</li>
                    </ul>
            </div>
            </div>

        <div id="graphIndicators" class="page" style="display:none;">
            <div class="indicator-section">
                <h3>미국 자금 현황</h3>
                <p>미국 정부, 은행, 시장에 현재 얼마나 많은 돈이 있는지 보여주는 핵심 지표들입니다.</p>
                <div class="indicator-buttons">
                    <button class="button" onclick="showGraph('WTREGEN')">미 정부 TGA 잔고</button>
                    <button class="button" onclick="showGraph('WRESBAL')">미 은행 지급준비금</button>
                    <button class="button" onclick="showGraph('RRPONTSYD')">연준 역레포 자금</button>
                    <button class="button" onclick="showGraph('MMMFFAQ027S')">MMF 잔고</button>
                    <button class="button" onclick="showGraph('WALCL')">연준 전체 자산 + 부채</button>
                </div>
            </div>
            <div class="indicator-section">
                <h3>금리</h3>
                <p>시중 자금의 비용을 나타내는 금리 지표들로, 경제의 건전성과 향후 방향을 예측하는 데 사용됩니다.</p>
                <div class="indicator-buttons">
                    <button class="button" onclick="showGraph('DGS3MO')">3개월 미 국채금리</button>
                    <button class="button" onclick="showGraph('DGS2')">2년물 미 국채금리</button>
                    <button class="button" onclick="showGraph('DGS10')">10년물 미 국채금리</button>
                    <button class="button" onclick="showGraph('YIELD_SPREAD')">미국 장단기 금리차</button>
                    <button class="button" onclick="showGraph('SOFR')">SOFR 금리</button>
                    <button class="button" onclick="showGraph('FEDFUNDS')">EFFR 금리</button>
                    <button class="button" onclick="showGraph('IORB')">IORB 금리</button>
                    <button class="button" onclick="showGraph('RRPONTSYAWARD')">역레포 금리</button>
                    <button class="button" onclick="showGraph('DPCREDIT')">연준 할인율</button>
                    <button class="button" onclick="showGraph('DRBLACBS')">미 은행 연체율(전체)</button>
                    <button class="button" onclick="showGraph('SOFR_FEDFUNDS_SPREAD')">SOFR, EFFR 스프레드</button>
                    <button class="button" onclick="showGraph('SOFR_IORB_SPREAD')">SOFR, IORB 스프레드</button>
                </div>
            </div>
            <div class="indicator-section">
                <h3>유동성</h3>
                <p>시중에 풀려있는 전체 통화량을 측정하는 지표로, 인플레이션과 경제 활동 수준을 가늠할 수 있습니다.</p>
                <div class="indicator-buttons">
                    <button class="button" onclick="showGraph('M2SL')">M2</button>
                    <button class="button" onclick="showGraph('M1SL')">M1</button>
                </div>
            </div>
            <div class="indicator-section">
                <h3>자산 가격</h3>
                <p>주식 시장의 대표적인 지수들로, 경제 전반의 건전성과 투자자 심리를 반영합니다.</p>
                <div class="indicator-buttons">
                    <button class="button" onclick="showGraph('NASDAQ100')">나스닥100 지수</button>
                    <button class="button" onclick="showGraph('SP500')">S&P500 지수</button>
                    <button class="button" onclick="showGraph('SP500_MCAP')">S&P500 시가총액</button>
                </div>
            </div>
            <div class="indicator-section">
                <h3>선행지표</h3>
                <p>미래의 경제 활동 방향을 예측하는 데 도움을 주는 지표들로, 소비와 산업 활동의 바로미터입니다.</p>
                <div class="indicator-buttons">
                    <button class="button" onclick="showGraph('ALTSALES')">자동차, 트럭 판매량</button>
                    <button class="button" onclick="showGraph('HOUST')">주택 착공 허가 건수</button>
                    <button class="button" onclick="showGraph('DCOILBRENTEU')">국제 유가</button>
                </div>
            </div>
            </div>

        <div id="graphPage" class="page" style="display:none;">
            <button class="back-btn" onclick="showGraphIndicators()">◄</button>
            <button class="info-btn" onclick="showInfo()">Info</button>
            <h2 id="graphTitle"></h2>
            <div id="graphDataSource"></div>
            <canvas id="myChart"></canvas>
            <div class="time-buttons">
                <button class="time-btn" onclick="updateChart('1M')">1M</button>
                <button class="time-btn" onclick="updateChart('6M')">6M</button>
                <button class="time-btn" onclick="updateChart('1Y')">1Y</button>
                <button class="time-btn" onclick="updateChart('5Y')">5Y</button>
                <button class="time-btn" onclick="updateChart('10Y')">10Y</button>
                <button class="time-btn" onclick="updateChart('All')">All</button>
            </div>
        </div>
        
        <div id="infoPage" class="page" style="display:none;">
            <button class="back-btn" onclick="goBackToGraph()">◄</button>
            <div class="info-box" style="margin-top: 20px;">
                <h2 id="infoTitle"></h2>
                <div id="infoContent"></div>
            </div>
        </div>
        <div id="aboutPage" class="page" style="display:none;">
            <div class="info-box" style="margin-top: 20px;">
                <h2>사이트 안내</h2>
                <p>'원뎅이의 미국 통화 유동성 현황'은 복잡한 경제 지표와 데이터 속에서 길을 잃지 않도록 돕는 나침반이 되고자 합니다. 실시간으로 업데이트되는 데이터를 통해, 지금 시장의 돈이 어디로 흐르고 있는지 직관적으로 파악해 보세요.</p>
                
                <h3>달러 유동성이 결국 주가를 결정합니다.</h3>
                <p>2022년 미국 연준 역레포 잔고 증가에 따라 S&P500 주식이 감소하며 폭락장을 맞이했습니다. 현재 <strong style="color: red;">미국 주식장은 통화의 방향과 속도</strong>가 더욱 중요해지고 있습니다. 따라서 <strong style="color: blue;">"원뎅이 미국 통화 유동성 현황"</strong>을 통해 유동성의 흐름을 손쉽게 예측하여 주식시장의 방향을 예측하고 수익을 극대화 하는데 도움이 되고자 합니다.</p>
                <img src="./icon/repo_sp500_plot.JPG" alt="역레포와 S&P500 관계" style="width: 100%; max-width: 600px; margin: 20px auto; display: block; border-radius: 8px;">

                <h3>주요 기능 안내</h3>
                <ul>
                    <li><strong>실시간 유동성 흐름:</strong> 각 경제 주체(정부, 중앙은행, MMF, 시장) 간의 월별 자금 이동 규모를 애니메이션으로 시각화하여 돈의 흐름을 쉽게 추적할 수 있습니다.</li>
                    <li><strong>핵심 금리 현황:</strong> SOFR, EFFR, 국채 금리 등 시장의 중요한 금리 지표들을 실시간으로 확인하고 그 의미를 파악할 수 있습니다.</li>
                    <li><strong>상세 데이터 그래프:</strong> TGA 잔고, M2 통화량, S&P500 지수 등 30여 개의 주요 경제 지표를 기간별 상세 그래프로 직접 분석할 수 있습니다. 각 지표에 대한 설명(Info)도 제공합니다.</li>
                </ul>

                <h3>데이터는 어떻게 해석해야 하나요?</h3>
                <p>메인 페이지의 애니메이션은 각 주체 간의 '최근 한 달간 자금 흐름 변화량'을 나타냅니다. 숫자의 의미는 다음과 같습니다.</p>
                <ul>
                    <li><strong>(정부의) TGA 잔고 (<span class="negative">- 음수</span>):</strong> 정부가 국채 발행 감소나 재정 지출 확대를 통해 시장에 돈을 풀고 있다는 의미입니다. (유동성 공급)</li>
                    <li><strong>(정부의) TGA 잔고 (<span class="positive">+ 양수</span>):</strong> 정부가 세금을 많이 걷거나 국채 발행을 늘려 시장의 돈을 흡수하고 있다는 의미입니다. (유동성 흡수)</li>
                    <br>
                    <li><strong>연준(FED) 유동성 (<span class="negative">- 음수</span>):</strong> 연준이 양적긴축(자산 매각) 등을 통해 시장의 돈을 거둬들이고 있다는 의미입니다. (유동성 흡수)</li>
                    <li><strong>연준(FED) 유동성 (<span class="positive">+ 양수</span>):</strong> 연준이 양적완화(자산 매입) 등을 통해 시장에 돈을 공급하고 있다는 의미입니다. (유동성 공급)</li>
                </ul>
                <p>결론적으로, <span style="font-weight: bold;">'시장(Market)'으로 들어오는 돈의 총합(Net Market Flow)</span>이 <span class="negative">파란색 음수(-)</span>이면 <span style="font-weight: bold;">시장 유동성이 줄어드는 것</span>으로, <span class="positive">빨간색 양수(+)</span>이면 <span style="font-weight: bold;">유동성이 풍부해지는 것</span>으로 해석할 수 있습니다.</p>

                <h3>데이터 출처 및 업데이트 주기</h3>
                <p>본 사이트의 대부분 데이터는 미국 연방준비제도 경제 데이터(<strong>FRED</strong>)와 재무부 금융 연구소(<strong>OFR</strong>)에서 제공하는 공식 데이터를 기반으로 합니다. 데이터는 각 지표의 발표 주기에 따라 매일 또는 매주 자동으로 업데이트됩니다.</p>
                <h3>웹사이트와 어플로도 출시하였어요!!</h3>
                <p>검색창에 <strong style="color: red;">"원뎅이 미국 통화 유동성 현황"</strong>을 검색하세요.</p>
                <p>구글 플레이 스토어에 <strong style="color: red;">"원뎅이 미국 통화 유동성 현황"</strong>을 검색하세요.</p>
            </div>
        </div>
        <div class="nav-bar">
            <button class="button" onclick="showLiquidityFlow()">유동성<br>현황</button>
            <button class="button" onclick="showInterestRateFlow()">금리<br>현황</button>
            <button class="button" onclick="showGraphIndicators()">그래프<br>지표</button>
            <button class="button" onclick="showAboutPage()">사이트<br>안내</button>
        </div>
        </div>
    
    <footer style="text-align: center; padding: 20px 20px 80px 20px; background-color: #f8f9fa; border-top: 1px solid #dee2e6; color: #6c757d; font-size: 12px;">
        <p>&copy; 2025 원뎅이의 미국 통화 유동성 현황. All Rights Reserved.</p>
        <p>본 사이트에서 제공하는 정보는 투자 참고용이며, 투자에 대한 모든 책임은 본인에게 있습니다.</p>
    </footer>

    <script>
        let myChart = null;
        let isDragging = false;
        let startX;
        let startScrollX;
        let currentIndicator = null;
        let currentGraphData = [];
        let dollarAnimationIntervals = [];
        const currentLanguage = 'ko'; // 이 페이지는 한국어 버전이므로 'ko'로 고정
        let analysisData = null;
        
        const BASE_ANIMATION_DURATION = 3000;
        const BASE_DOLLAR_SIZE = 37.5; 
        const NUM_DOLLAR_ANIMATIONS = 3;

        const FUNCTION_BASE_URL = '/.netlify/functions/get-csv-data';
        
        const dataCache = new Map();
        const CACHE_TTL = 3600 * 1000;

        // ▼▼▼ 번역 텍스트 모음 (한국어 버전이므로 한글만 필요) ▼▼▼
        const translations = {
            ko: {
                aiAnalysisTitle: 'Ai 인공지능 Daily 분석',
                graphBtn: '그래프',
                infoBtnText: 'Info',
                backBtnText: '◄',
                netMarketFlowLabel: '<b>시장 Total 유동 공급량<br> = ',
                tooltip: {
                    tga: {
                        label: 'TGA 잔고:',
                        desc: `<p>최근 한 달 동안, 미국 재무부 잔고 변화를 나타냅니다.</p><p><b>+양수 :</b> 시장에서 재무부로 달러 유동성 흡수<br><b>-음수 :</b> 미국 재무부가 시장에 달러 유동성 공급</p>`
                    },
                    fed: {
                        label: '연준 유동성:',
                        desc: `<p>최근 한 달 동안, 연준의 순자산(국채+모기지채 등)과 부채의 변화를 나타냅니다.</p>
                               <p><b>+양수 :</b> 시장의 채권 등 자산 구매를 통해 달러를 시장에 공급 (or) 역레포 자금을 시장에 품<br><b>-음수 :</b> 자산 매각을 통해 시중의 달러를 다시 회수 (or) 시장으로부터 역레포 자금을 충당(긴축)</p><hr>`,
                        part1: '연준 자산 변화량 =',
                        part2: '연준의 부채 (역레포와 지급준비금) 변화량 ='
                    },
                    mmf_fed: {
                        label: 'MMF -> FED:',
                        desc: `<p>최근 한 달 동안, MMF가 연준에게 돈을 맡긴 자금의 양 변화를 나타냅니다.</p><p><b>+양수 :</b> MMF가 연준에게 역레포 자금을 빌려줌<br><b>-음수 :</b> 연준에게 빌려준 역레포 자금을 다시 회수</p>`
                    },
                    mmf_market: {
                        label: 'MMF ->시장:',
                        desc: `<p>최근 한 달 동안, MMF가 시장에 돈을 공급한 자금의 양 변화를 나타냅니다.<br>이 결과는 MMF가 시장에 공급한 유동성에서 시장이 MMF에 투자한 양을 뺀 결과입니다.</p>
                               <p><b>+양수 :</b> MMF가 시장에 유동성 공급량이 큰 상황<br><b>-음수 :</b> 시장이 MMF에 자금을 투자한 양이 큰 상황</p><hr>`,
                        part1: 'MMF가 시장으로 유동성 공급량 =',
                        part2: '시장이 MMF에 투자량 ='
                    },
                    sofr: { label: 'SOFR 금리 :', desc: `<p>SOFR 금리는 미국에서 한밤사이 동안 금융기관이 다른 금융기관에 담보(예: 국채)를 제공하고 자금을 빌리는 비용을 나타냅니다.</p><p><b>왜 중요한가? :</b> SOFR은 단기 자금 시장의 유동성과 수요-공급 상황을 반영합니다. 예를 들어, 시장에 자금이 부족하면 SOFR이 상승하고, 자금이 풍부하면 하락합니다.</p>` },
                    effr: { label: 'EFFR 금리 :', desc: `<p>EFFR 금리는 은행들이 연준에 예치된 자금을 시중은행 간 상호 대출할 때 적용되는 실제 금리를 의미합니다.</p><p><b>왜 중요한가? :</b> EFFR 금리가 높다는건, 은행간의 대출 부담을 높여서 시중에 빌리는 돈의 규모를 축소한다는 의미가 될 수 있습니다.</p>` },
                    rrp_rate: { label: '역레포 금리 :', desc: `<p>연준이 금융기관으로부터 자금을 빌릴 때 지급하는 금리로, 시중에 넘치는 유동성을 흡수하기 위한 기준 금리입니다.</p><p><b>왜 중요한가? :</b> 역레포 금리가 높아질수록 시중의 유동성을 흡수하는 역할을 합니다.</p>` },
                    tb3ms: { label: '3개월 미 국채금리 :', desc: `<p>3개월 만기 미국 재무부 증권의 수익률로, 단기 시장 금리와 인플레이션 기대치를 반영합니다.</p><p><b>왜 중요한가? :</b> 3개월 금리가 상승한다는 의미는, 미국 정부가 국채 발행을 많이해서 원하는 곳에 돈을 많이 풀고 싶다는 간접적인 의미가 될 수 있고, 반대로 미국채 수요가 적어서 금리가 상승할 수 있습니다.</p>` },
                    tb1yr: { label: '2년물 미 국채금리 :', desc: `<p>2년 만기 미국 재무부 증권의 수익률로, 중단기 금리와 경제 전망을 반영합니다.</p><p><b>왜 중요한가? :</b> 2년 만기 금리가 상승한다는 의미는, 미국 정부가 국채 발행을 많이해서 원하는 곳에 돈을 많이 풀고 싶다는 간접적인 의미가 될 수 있고, 반대로 미국채 수요가 적어서 금리가 상승할 수 있습니다.</p>` },
                    tb10yr: { label: '10년물 미 국채금리 :', desc: `<p>10년 만기 미국 재무부 증권의 수익률로, 시장의 경제 성장 기대치와 인플레이션 전망을 반영하는 핵심 지표입니다.</p><p><b>왜 중요한가? :</b> 10년물 미국채 금리는 경제의 현재 상황과 미래 전망을 보여주는 바로미터 역할을 하며, 정부의 재정 정책과 시장의 투자 심리가 복합적으로 반영된 지표입니다.</p>` },
                    discount: { label: '연준 할인율 :', desc: `<p>연준 할인율은 연준이 상업 은행에 대출할 때 적용하는 이자율로, 금융기관의 자금 조달 비용을 결정합니다. </p><p><b>왜 중요한가? :</b> 할인율이 낮게 되면, 연준이 시중 은행에 돈을 풀고 싶다는 의미가 될 수 있습니다.</p>` },
                    sofr_effr_spread: {
                        label: 'SOFR EFFR 스프레드:',
                        label_mobile: 'SOFR EFFR<br>스프레드:',
                        desc: `<p>만약 SOFR이 급등하거나 EFFR과의 스프레드가 확대된다면, 이는 은행이 시중으로부터 달러 수요가 급증했음을 의미합니다.</p><p>반대로 스프레드가 축소되거나 마이너스면 시장의 유동성이 풍부하거나 무담보 대출 환경이 개선된 신호일 수 있습니다.</p>`
                    }
                },
                indicatorTitles: {
                    'WTREGEN': '미 정부 TGA 잔고', 'WRESBAL': '미 은행 지급준비금', 'RRPONTSYD': '연준 역레포 자금', 'MMMFFAQ027S': 'MMF 잔고', 'WALCL': '연준 전체 자산 + 부채',
                    'SOFR': 'SOFR 금리', 'FEDFUNDS': 'EFFR 금리', 'IORB': 'IORB 금리', 'DGS3MO': '3개월 미 국채금리', 'DGS2': '2년물 미 국채금리', 'DGS10': '10년물 미 국채금리', 'DPCREDIT': '연준 할인율',
                    'DRBLACBS': '미 은행 연체율(전체)', 'M2SL': 'M2', 'M1SL': 'M1', 'NASDAQ100': '나스닥100 지수', 'SP500': 'S&P500 지수', 'SP500_MCAP': 'S&P500 시가총액',
                    'RRPONTSYAWARD': '역레포 금리', 'ALTSALES': '자동차, 트럭 판매량', 'HOUST': '주택 착공 허가 건수', 'DCOILBRENTEU': '국제 유가',
                    'SOFR_FEDFUNDS_SPREAD': 'SOFR, EFFR 스프레드', 'SOFR_IORB_SPREAD': 'SOFR, IORB 스프레드', 'YIELD_SPREAD': '미국 장단기 금리차'
                },
                infoData: {
                    'WTREGEN': {'title': '미 정부 TGA 잔고', 'content': {'경제적 의미': 'Treasury General Account (TGA)는 미국 정부의 현금 잔고 입니다. 이 잔고의 증가는 정부가 시장 유동성을 흡수했음을 말하며, 감소는 재무부가 시장에 유동성을 정책을 통해 공급했음을 의미할 수 있습니다.', '왜 필요한 지표인가': 'TGA 잔고는 유동성(시장에 순환하는 돈의 양)에 직접적인 영향을 미칩니다. 잔고가 급격히 변동하면 단기 금리나 금융 시장 안정성에 영향을 줄 수 있어 모니터링이 필요합니다.'}},
                    'WRESBAL': {'title': '미 은행 지급준비금', 'content': {'경제적 의미': '미 은행이 연방준비제도(FRB)에 예치한 의무적 예금으로, 은행 시스템의 유동성을 조절하는 데 사용됩니다. 이 수치가 높으면 은행이 대출을 줄일 가능성이 있고, 낮으면 대출이 증가할 수 있습니다. 반대로 준비금이 높다는건 은행 시스템에 유동성이 풍부하다는 것을 의미가 될 수 있습니다.', '왜 필요한 지표인가': '지급준비금은 통화 공급량과 신용 창출에 영향을 미치며, 연준의 통화 정책(예: 양적 완화 또는 긴축)의 효과를 평가하는 데 핵심 지표입니다. 경제 과열이나 침체를 방지하기 위해 모니터링됩니다.'}},
                    'M2SL': {'title': 'M2', 'content': {'경제적 의미': 'M2는 전통적인 은행 활동에 의한 화폐 공급량을 의미합니다. 예를 들면 은행에서의 현금, 수시입출금 예금, 저축 예금, 그리고 소액의 정기 예금을 포함합니다. 하지만 최근들어 MMF(Money Market Fund)의 자금 조달로 인한 M2에 간접적인 영향을 줄 수는 있겠으나, MMF 자금 유동성이 급격히 변동하더라도, M2 수치에 즉각적으로 반영되진 않을 수 있습니다. Stable Coin에 의한 자금 유동성 또한 M2에 직접 포함되지는 않습니다.', '왜 필요한 지표인가': 'M2는 전통적인 인플레이션, 경제 성장, 소비 동향을 예측하는 데 사용됩니다. 급격한 증가나 감소는 통화 정책 조정(예: 금리 인상/인하)의 신호로 해석될 수 있어 중요합니다.'}},
                    'M1SL': {'title': 'M1', 'content': {'경제적 의미': 'M1은 화폐 공급량의 좁은 정의로, 현금과 수시입출금 예금을 포함합니다. 이는 가장 유동성이 높은 자산을 나타냅니다. M2와 마찬가지로 MMF와 Stable Coin에 의한 영향성은 제한적입니다.', '왜 필요한 지표인가': 'M1은 단기적인 지출 능력과 유동성 수준을 반영하며, 경제 활동의 초기 신호를 제공합니다. 특히 통화 정책의 실시간 영향을 분석하는 데 유용합니다.'}},
                    'SOFR': {'title': 'SOFR 금리', 'content': {'경제적 의미': 'SOFR은 Secured Overnight Financing Rate의 약자로, 미국에서 한밤사이(overnight) 동안 담보(예: 미국 재무부 증권)를 기반으로 한 대출 거래의 이자율을 평균한 기준 금리입니다. 즉, SOFR은 금융기관(예: 증권사, 헤지펀드 등)이 다른 금융기관으로부터 담보를 제공하고 자금을 빌리는 비용을 나타냅니다.', '왜 필요한 지표인가': 'SOFR은 단기 자금 시장의 유동성과 수요-공급 상황을 반영합니다. 예를 들어, 시장에 자금이 부족하면 SOFR이 상승하고, 자금이 풍부하면 하락합니다. 이는 금융기관이 하루 동안 자금을 조달하거나 투자할 때 참고하는 중요한 기준 금리입니다. 시중에 자금이 넘치는지, 안넘치는지의 지표가 될 수 있습니다.'}},
                    'FEDFUNDS': {'title': 'EFFR 금리', 'content': {'경제적 의미': 'EFFR는 Effective Federal Funds Rate의 약자로, 은행들이 연준에 예치된 자금을 다른 은행에 상호 대출할 때 적용되는 실제 금리를 의미합니다. 연준 기준 금리와 밀접하게 연관됩니다.', '왜 필요한 지표인가': 'EFFR은 연준의 통화 정책 방향을 보여주며, 경제 성장, 인플레이션, 고용에 영향을 미칩니다. 예를 들면, EFFR 금리가 높다는건, 은행간의 대출 부담을 높여서 시중에 빌리는 돈의 규모를 축소한다는 의미가 될 수 있습니다. 결과적으로 긴축 효과를 냅니다.'}},
                    'IORB': {'title': 'IORB 금리', 'content': {'경제적 의미': 'IORB(Interest on Reserve Balances)는 은행들이 연준에 예치한 초과 지급준비금에 대해 연준이 지급하는 이자율입니다.', '왜 필요한 지표인가': '연준은 이 금리를 조절함으로써 은행들의 초과준비금 보유 여부와 유동성 공급에 영향을 줍니다. IORB는 연준의 정책금리(페드 펀드 금리) 목표 범위 하단에 위치하며, 은행들이 자금을 대출로 제공하거나 지급준비금으로 보유할 때의 유인을 조절하는 중요한 도구입니다.'}},
                    'SOFR_FEDFUNDS_SPREAD': {'title': 'SOFR, EFFR 스프레드', 'content': {'경제적 의미': '만약 SOFR이 급등하거나 EFFR과의 스프레드가 확대된다면, 이는 은행이 시중으로부터 달러 수요가 급증했음을 의미합니다. 이 같은 상황은 유동성 긴축이나 시장 불안의 신호를 의미할 수 있습니다. 반대로 스프레드가 축소되면 시장의 유동성이 풍부하거나 무담보 대출 환경이 개선된 신호일 수 있습니다.', '왜 필요한 지표인가': '이 스프레드 지표를 통해, 시장의 유동성 상황을 평가하고 미리 파악하는데 도움을 받을 수 있습니다.'}},
                    'SOFR_IORB_SPREAD': {'title': 'SOFR, IORB 스프레드', 'content': {'경제적 의미': 'SOFR이 IORB 이하로 유지되면 시중 유동성이 풍부해지고, 은행 간 자금 조달이 원활하다는 것을 의미합니다. (=유동성 과잉 신호)<br>반대로 SOFR이 IORB보다 높아지면, 은행들이 자금을 연준에 초과준비금으로 예치하는 것보다 시장으로부터 자금을 빌리는 것이 더 비용이 많이 든다는 것을 의미합니다. 이는 은행 간 자금 수요가 많아져 유동성 부족이 발생했음을 시사할 수 있습니다.', '왜 필요한 지표인가': '이 스프레드 지표를 통해, 시장의 유동성 상황을 평가하고 미리 파악하는데 도움을 받을 수 있습니다.'}},
                    'DGS3MO': {'title': '3개월 미 국채금리', 'content': {'경제적 의미': '3개월 만기 미국 재무부 증권의 수익률로, 단기 시장 금리와 인플레이션 기대치를 반영합니다.', '왜 필요한 지표인가': '단기 금리 동향을 파악하고, 경제 회복 또는 침체 신호를 분석하는 데 유용합니다. 3개월 만기 국채 금리가 상승한다는 의미는, 미국 정부가 국채 발행을 많이해서 원하는 곳에 돈을 많이 풀고 싶다는 간접적인 의미가 될 수 있고, 반대로 미국채 수요가 적어서 금리가 상승할 수 있습니다.'}},
                    'DGS2': {'title': '2년물 미 국채금리', 'content': {'경제적 의미': '2년 만기 미국 재무부 증권의 수익률로, 중단기 금리와 경제 전망을 반영합니다.', '왜 필요한 지표인가': '단기와 장기 금리 간 관계를 통해 경제 성장 기대치나 인플레이션 우려를 파악할 수 있어, 투자자와 정책 입안자에게 중요합니다. 또한 금리가 상승한다는 의미는, 미국 정부가 국채 발행을 많이해서 원하는 곳에 돈을 많이 풀고 싶다는 간접적인 의미가 될 수 있고, 반대로 미국채 수요가 적어서 금리가 상승할 수 있습니다.'}},
                    'DGS10': {'title': '10년물 미 국채금리', 'content': {'경제적 의미': '10년물 미국채 금리는 10년 만기 미국 재무부 증권의 수익률을 의미합니다. 이는 중장기 금리를 대표하며, 시장의 경제 성장 기대치와 인플레이션 전망을 반영하는 핵심 지표입니다. 투자자들이 미래에 대한 긍정적인 전망을 하면 금리가 오르고, 비관적인 전망을 하면 금리가 떨어지는 경향이 있습니다.', '왜 필요한 지표인가': '10년물 미국채 금리는 경제의 현재 상황과 미래 전망을 보여주는 바로미터 역할을 하며, 정부의 재정 정책과 시장의 투자 심리가 복합적으로 반영된 지표입니다.'}},
                    'YIELD_SPREAD': {'title': '미국 장단기 금리차', 'content': {'경제적 의미': '1. 투자자들의 경기 불안: 경기침체가 예상되면 안전한 장기 국채로 자금이 몰리며 금리가 하락합니다.<br>2. 긴축적 통화 정책: 연준이 인플레이션 억제를 위해 기준금리를 올리면 단기 금리가 상승합니다.<br>3. 대출과 투자 둔화: 기업과 가계가 고금리로 인해 자금조달이 어려워지면서 소비와 투자가 감소합니다.<br>이 과정에서 금리 역전은 시장의 불확실성과 향후 경기 둔화 가능성을 반영합니다.', '왜 필요한 지표인가': '장단기 금리가 역전될 때, 투자자들이 경기침체를 예상하고 장기 국채를 매수하면서 장기 금리가 하락하고, 동시에 연준(Fed)이 단기 금리를 높이는 긴축정책을 통해 물가 상승을 억제하려 할 때 단기 금리가 상승합니다. 평균적으로 금리 역전 후 12~18개월 내에 경기침체가 발생하는 경향이 있습니다.', '결론': '장단기 금리 역전은 경기침체의 신뢰할 만한 선행 지표로 인정받고 있지만, 이를 절대적 기준으로 삼기는 어렵습니다. 역전이 발생하면 투자자와 정책 결정자들은 경기 둔화를 대비할 필요가 있지만, 다른 경제 지표(실업률, 소비자 지출 등)와 함께 종합적으로 분석해야 합니다.'}},
                    'RRPONTSYD': {'title': '연준 역레포 자금', 'content': {'경제적 의미': 'Reverse Repurchase Agreement(RRP)는 연준이 금융기관으로부터 자산을 매입하며 시중의 유동성을 흡수하는 도구입니다. 이 금액은 시장의 묶여있는 돈. 즉, 잉여 자금을 보여줍니다.', '왜 필요한 지표인가': '연준이 금리를 통제하거나 유동성을 조절할 때 사용되며, 시장의 과도한 유동성(예: 인플레이션 위험)을 관리하는 데 필요합니다. 즉, 연레포 자금이 증가한다는 것은, 시중에 풀린 돈을 중앙은행에 묶어둔다는 뜻 입니다. 이렇게 되면 유동성이 긴축되어 시장의 주가가 감소할 수 있습니다.'}},
                    'MMMFFAQ027S': {'title': 'MMF 잔고', 'content': {'경제적 의미': 'Money Market Fund(MMF)의 총 자산 잔고로, 투자자들이 안전 자산에 얼마나 많은 자금을 넣는지 보여줍니다. 주로 기준금리가 높은 시기에 수익율이 높아서 몰리거나, 시장(주식) 가격이 불안정할 수 있다고 예상되면 MMF로 자금이 몰리게 됩니다.', '왜 필요한 지표인가': 'MMF 잔고는 투자 심리와 위험 회피 성향을 반영하며, 금융 시장 불확실성이 높을 때 증가하는 경향이 있어 경제 안정성 평가에 유용합니다.'}},
                    'SP500': {'title': 'S&P500 지수', 'content': {'경제적 의미': '미국 500대 기업의 주식 성과를 종합한 지수로, 주식 시장의 전반적인 건강 상태를 나타냅니다.', '왜 필요한 지표인가': '경제 성장, 기업 수익, 투자자 신뢰를 반영하며, 소비자 지출과 연결되므로 거시경제 분석에 필수적입니다.'}},
                    'DPCREDIT': {'title': '연준 할인율', 'content': {'경제적 의미': '연준이 상업 은행에 대출할 때 적용하는 이자율로, 금융기관의 자금 조달 비용을 결정합니다. 할인율이 낮게 되면, 연준이 시중 은행에 돈을 풀고 싶다는 의미가 될 수 있습니다.', '왜 필요한 지표인가': '은행의 유동성 지원과 신용 경색 방지에 사용되며, 연준의 긴급 통화 정책을 평가하는 데 중요합니다.'}},
                    'DRBLACBS': {'title': '미 은행 연체율(전체)', 'content': {'경제적 의미': '은행 대출 중 연체된 비율로, 대출자의 상환 능력과 신용 위험을 나타냅니다.', '왜 필요한 지표인가': '경제 침체 신호나 금융 시스템의 건전성을 평가하며, 대출 정책과 규제 강화의 기초 자료로 사용됩니다.'}},
                    'NASDAQ100': {'title': '나스닥100 지수', 'content': {'경제적 의미': '기술주 중심의 100개 기업 주가를 반영한 지수로, 기술 섹터의 성과를 보여줍니다.', '왜 필요한 지표인가': '기술 산업의 성장과 혁신을 반영하며, 글로벌 경제에서 기술 의존도가 높아짐에 따라 중요한 기준이 됩니다.'}},
                    'WALCL': {'title': '연준 전체 자산 + 부채', 'content': {'경제적 의미': '연준의 총 자산(예: 채권 보유량 등)과 부채(예: 역레포 및 준비금 등)를 합친 금액으로, 연준의 재무 상태를 나타냅니다.', '왜 필요한 지표인가': '양적 완화나 긴축 정책의 규모를 보여주며, 연준의 통화 정책과 시장 유동성에 미치는 영향을 분석하는 데 필수적입니다.'}},
                    'SP500_MCAP': {'title': 'S&P500 시가총액', 'content': {'경제적 의미': 'S&P500 지수에 포함된 기업들의 총 시가총액입니다. 이는 미국 주식 시장의 전반적인 규모와 가치를 나타내며, 경제의 전반적인 건전성과 투자 심리를 반영합니다.', '왜 필요한 지표인가': '주식 시장의 과열 또는 침체 여부를 판단하는 데 중요한 지표입니다. 시가총액의 증가는 경제 성장과 기업 수익성 개선을, 감소는 경기 둔화나 불확실성 증대를 시사할 수 있습니다.'}},
                    'RRPONTSYAWARD': {'title': '역레포 금리', 'content': {'경제적 의미': '연준이 금융기관으로부터 자금을 빌릴 때 지급하는 금리로, 시중에 넘치는 유동성을 흡수하기 위한 기준 금리입니다. 즉, 금리가 높아질수록 시중의 유동성을 흡수하는 역할을 합니다.', '왜 필요한 지표인가': '시장의 유동성이 지나치게 풍부할 때 연준의 의도로 금리가 떨어지는 것을 막는 역할을 합니다. 왜냐하면 역레포 금리는 금융기관이 연준에 돈을 맡길 때 보장받는 최저 수익률 역할을 합니다. 따라서 금융기관들은 역레포 금리보다 낮은 금리로 다른 곳에 돈을 빌려주지 않으려 하기 때문에, 단기 금리가 연준의 목표 수준 이하로 떨어지는 것을 막는 역할을 합니다.'}},
                    'ALTSALES': {'title': '자동차, 트럭 판매량', 'content': {'경제적 의미': '자동차 및 모든 승용차 판매량에 대한 미 상무부 경제분석국의 보고입니다. 이 지수가 높다면, 강한 경제를 나타냅니다.', '왜 필요한 지표인가': '미국 시장의 주요한 경제 **선행지표** 중 하나입니다.'}},
                    'HOUST': {'title': '주택 착공 허가 건수', 'content': {'경제적 의미': '주택 착공은 특정 달에 시작된 새로운 주거 건설 프로젝트의 수를 의미합니다. 주택 착공 추정치에는 기존 기반 위에 완전히 재건되는 건물의 단위도 포함됩니다. 이 지수가 높다면, 강한 경제를 나타냅니다.', '왜 필요한 지표인가': '미국 시장의 주요한 경제 **선행지표** 중 하나입니다.'}},
                    'DCOILBRENTEU': {'title': '국제 유가', 'content': {'경제적 의미': '유럽과 전 세계 유가의 기준이 되는 지표를 의미합니다.', '왜 필요한 지표인가': '역사적으로 유가가 감소하면, 경제 부흥이 일어나고, 유가가 상승하면 경기 침체 및 하락 국면을 보이기도 합니다. 따라서 중요하게 모니터링할 지표입니다.'}}
                }
            }
        };

        // 이하 기능 관련 JavaScript 코드는 기존과 동일하게 유지됩니다.
        // setLanguage, translations 변수 등 불필요한 부분만 제거되었습니다.

        async function fetchAndCacheData(indicator) {
            if (dataCache.has(indicator)) {
                const { data, timestamp } = dataCache.get(indicator);
                if (Date.now() - timestamp < CACHE_TTL) {
                    return Promise.resolve(data);
                }
            }
            const functionUrl = `${FUNCTION_BASE_URL}?indicator=${indicator}`;
            try {
                const response = await fetch(functionUrl);
                if (!response.ok) {
                    const errorBody = await response.json();
                    const errorMsg = currentLanguage === 'ko' 
                        ? `'${translations[currentLanguage].indicatorTitles[indicator] || indicator}' 데이터를 찾을 수 없거나 불러오지 못했어요! (${response.status}: ${errorBody.error || response.statusText})`
                        : `Could not find or load data for '${translations[currentLanguage].indicatorTitles[indicator] || indicator}'! (${response.status}: ${errorBody.error || response.statusText})`;
                    throw new Error(errorMsg);
                }
                const text = await response.text();
                const parsedData = await parseCSV(text);
                if (parsedData.length > 0) {
                    parsedData.sort((a, b) => new Date(a.date) - new Date(b.date));
                    dataCache.set(indicator, { data: parsedData, timestamp: Date.now() });
                }
                return parsedData;
            } catch (error) {
                 console.error(`Failed to fetch ${indicator}:`, error);
                 throw error;
            }
        }

        const indicatorUnits = {
            'WTREGEN': 'Billions of U.S. Dollars', 'WRESBAL': 'Billions of Dollars', 'RRPONTSYD': 'Billions of Dollars', 'MMMFFAQ027S': 'Billions of Dollars', 'WALCL': 'Billions of Dollars',
            'M2SL': 'Billions of Dollars', 'M1SL': 'Billions of Dollars', 'SP500_MCAP': 'Billions of Dollars', 'SOFR': 'Percent (%)', 'FEDFUNDS': 'Percent (%)', 'IORB': 'Percent (%)', 'DGS3MO': 'Percent (%)',
            'DGS2': 'Percent (%)', 'DGS10': 'Percent (%)', 'DPCREDIT': 'Percent (%)', 'DRBLACBS': 'Percent (%)', 'NASDAQ100': 'Index', 'SP500': 'Index',
            'RRPONTSYAWARD': 'Percent (%)', 'ALTSALES': 'Millions of Units', 'HOUST': 'Thousands of Units', 'DCOILBRENTEU': 'Dollars per Barrel',
            'SOFR_FEDFUNDS_SPREAD': 'Percent (%)', 'SOFR_IORB_SPREAD': 'Percent (%)', 'YIELD_SPREAD': 'Percent (%)'
        };
        
        const spreadConfigs = {
            'SOFR_FEDFUNDS_SPREAD': [
                { code: 'SOFR', label: 'SOFR', color: '#007bff' },
                { code: 'FEDFUNDS', label: 'EFFR', color: 'red' }
            ],
            'SOFR_IORB_SPREAD': [
                { code: 'SOFR', label: 'SOFR', color: '#007bff' },
                { code: 'IORB', label: 'IORB', color: 'red' }
            ]
        };

        async function parseCSV(text) {
            const lines = text.trim().split('\n');
            if (lines.length <= 1) return [];
            const headers = lines[0].split(',').map(h => h.trim());
            let dateColIndex = headers.findIndex(h => h.toLowerCase() === 'date' || h.toLowerCase() === 'data');
            const valueColName = headers.find((h, i) => i !== dateColIndex);
            const valueColIdx = headers.indexOf(valueColName);
            if (dateColIndex === -1 || valueColIdx === -1) return [];
            const parsedData = [];
            for (let i = 1; i < lines.length; i++) {
                const columns = lines[i].split(',');
                if (columns.length > Math.max(dateColIndex, valueColIdx)) {
                    const dateStr = columns[dateColIndex].trim();
                    const valueStr = columns[valueColIdx].trim();
                    const dateObj = new Date(dateStr);
                    const valueNum = parseFloat(valueStr);
                    if (!isNaN(dateObj.getTime()) && !isNaN(valueNum) && valueStr !== '.') {
                        parsedData.push({ date: dateStr, value: valueNum });
                    }
                }
            }
            return parsedData;
        }
        
        async function loadFinancialAnalysis() {
            try {
                const response = await fetch('csvfile/financial_analysis.json');
                if (!response.ok) {
                    throw new Error('Network response was not ok.');
                }
                analysisData = await response.json(); // Fetch and store in global variable
                displayFinancialAnalysis(); // Display for the default language

            } catch (error) {
                console.error('Failed to load analysis data:', error);
                const errorMsg = currentLanguage === 'ko' ? '분석 데이터를 불러오는 데 실패했습니다.' : 'Failed to load analysis data.';
                const liquidityContainer = document.getElementById('liquidity-analysis-container');
                if(liquidityContainer) liquidityContainer.textContent = errorMsg;
                const interestRateContainer = document.getElementById('interest-rate-analysis-container');
                if(interestRateContainer) interestRateContainer.textContent = errorMsg;
                setAiAnalysisTitles(null);
            }
        }

        function displayFinancialAnalysis() {
            if (!analysisData) return; // Exit if data hasn't been loaded

            const liquidityContainer = document.getElementById('liquidity-analysis-container');
            const interestRateContainer = document.getElementById('interest-rate-analysis-container');

            // Select the correct analysis text based on the current language
            const liquidityKey = currentLanguage === 'en' ? 'liquidity_analysis_en' : 'liquidity_analysis';
            const interestKey = currentLanguage === 'en' ? 'interest_rate_analysis_en' : 'interest_rate_analysis';

            if (liquidityContainer && analysisData[liquidityKey]) {
                liquidityContainer.innerHTML = analysisData[liquidityKey];
            }

            if (interestRateContainer && analysisData[interestKey]) {
                interestRateContainer.innerHTML = analysisData[interestKey];
            }
            
            // Set titles with the date from the JSON file
            if (analysisData.date) {
                setAiAnalysisTitles(analysisData.date);
            } else {
                setAiAnalysisTitles(null);
            }
        }
        
        function setAiAnalysisTitles(analysisDate) {
            const titleText = translations[currentLanguage].aiAnalysisTitle;
            const fullTitle = analysisDate 
                ? `${titleText}<span class="update-date-span" style="font-weight: bold;">(Update Date: ${analysisDate})</span>`
                : titleText;

            const liquidityTitleEl = document.getElementById('ai-analysis-title-liquidity');
            const interestTitleEl = document.getElementById('ai-analysis-title-interest');

            if (liquidityTitleEl) {
                liquidityTitleEl.innerHTML = fullTitle;
            }
            if (interestTitleEl) {
                interestTitleEl.innerHTML = fullTitle;
            }
        }
        
        function updateMetaTagsForLanguage(lang) {
            const langData = translations[lang];
            if (!langData) return;

            // <title> 태그 업데이트
            document.title = langData.pageTitle;

            // <meta name="description"> 태그 업데이트
            const descriptionTag = document.querySelector('meta[name="description"]');
            if (descriptionTag) {
                descriptionTag.setAttribute('content', langData.metaDescription || translations['ko'].description); // 영어 설명이 없으면 한국어 기본값 사용
            }

            // Open Graph(og) 태그 업데이트 (소셜 공유용)
            const ogTitleTag = document.querySelector('meta[property="og:title"]');
            if (ogTitleTag) {
                ogTitleTag.setAttribute('content', langData.pageTitle);
            }
            const ogDescriptionTag = document.querySelector('meta[property="og:description"]');
            if (ogDescriptionTag) {
                ogDescriptionTag.setAttribute('content', langData.metaDescription || translations['ko'].description);
            }
        }

        function setLanguage(lang) {
            currentLanguage = lang;
            updateMetaTagsForLanguage(lang);
            document.documentElement.lang = lang;

            document.querySelectorAll('[data-lang-key]').forEach(el => {
                const key = el.getAttribute('data-lang-key');
                if (translations[lang][key]) {
                    el.innerHTML = translations[lang][key];
                }
            });

            document.querySelectorAll('.lang-selector').forEach(selector => {
                selector.querySelector('.lang-btn.active').classList.remove('active');
                selector.querySelector(`.lang-btn[onclick="setLanguage('${lang}')"]`).classList.add('active');
            });
            
            const activePage = document.querySelector('.page[style*="block"]').id;
            if (activePage === 'liquidityFlow') {
                updateLiquidityFlowAnimation();
            } else if (activePage === 'interestRateFlow') {
                updateInterestRateFlowData();
            } else if (activePage === 'graphPage') {
                showGraph(currentIndicator); 
            } else if (activePage === 'infoPage') {
                showInfo(); 
            }
            
            displayFinancialAnalysis(); // Refresh AI analysis text on language change
        }


        window.addEventListener('load', () => {
            showPage('liquidityFlow');
            loadFinancialAnalysis();
            try {
                if (window.Kakao && !Kakao.isInitialized()) {
                    Kakao.init('4ae404e0f6a8321cf2e7533ad956ddcc');
                }
            } catch (e) {
                console.error("Kakao SDK init failed:", e);
            }
            setLanguage('ko'); 
        });

        const pages = ['liquidityFlow', 'interestRateFlow', 'graphIndicators', 'graphPage', 'infoPage', 'aboutPage'];
        function showPage(pageId) {
            pages.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.style.display = id === pageId ? 'block' : 'none';
                }
            });
            if (pageId === 'liquidityFlow') { updateLiquidityFlowAnimation(); } 
            else if (pageId === 'interestRateFlow') { updateInterestRateFlowData(); stopLiquidityFlowAnimation(); }
            else { stopLiquidityFlowAnimation(); }
        }

        function showLiquidityFlow() { showPage('liquidityFlow'); }
        function showInterestRateFlow() { showPage('interestRateFlow'); }
        function showGraphIndicators() { showPage('graphIndicators'); }
        function showAboutPage() { showPage('aboutPage'); }

        function shareOn(platform) {
            const pageUrl = encodeURIComponent(window.location.href);
            const pageTitle = encodeURIComponent(document.title);
            let shareUrl;

            switch (platform) {
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?url=${pageUrl}&text=${pageTitle}`;
                    window.open(shareUrl, '_blank', 'width=600,height=400');
                    break;
                case 'facebook':
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${pageUrl}`;
                    window.open(shareUrl, '_blank', 'width=600,height=400');
                    break;
                case 'line':
                    shareUrl = `https://social-plugins.line.me/lineit/share?url=${pageUrl}`;
                    window.open(shareUrl, '_blank', 'width=600,height=400');
                    break;
                case 'kakao':
                    if (window.Kakao && Kakao.isInitialized()) {
                        Kakao.Share.sendDefault({
                            objectType: 'feed',
                            content: {
                                title: document.title,
                                description: document.querySelector('meta[name="description"]').content,
                                imageUrl: document.querySelector('meta[property="og:image"]').content,
                                link: {
                                    mobileWebUrl: window.location.href,
                                    webUrl: window.location.href,
                                },
                            },
                            buttons: [
                                {
                                    title: currentLanguage === 'ko' ? '웹으로 보기' : 'View on Web',
                                    link: {
                                        mobileWebUrl: window.location.href,
                                        webUrl: window.location.href,
                                    },
                                },
                            ],
                        });
                    } else {
                        alert(currentLanguage === 'ko' ? '카카오 공유 기능이 준비되지 않았습니다.' : 'Kakao Share is not ready.');
                    }
                    break;
            }
        }
        
        function copyLink() {
            const urlToCopy = 'https://americayoudongsung.netlify.app/';
            navigator.clipboard.writeText(urlToCopy).then(() => {
                alert(currentLanguage === 'ko' ? '링크가 복사되었습니다!' : 'Link copied!');
            }).catch(err => {
                console.error('Failed to copy link:', err);
                alert(currentLanguage === 'ko' ? '링크 복사에 실패했습니다.' : 'Failed to copy link.');
            });
        }


        async function showGraph(indicator) {
            currentIndicator = indicator;
            showPage('graphPage');
            const langDict = translations[currentLanguage];
            document.getElementById('graphTitle').textContent = langDict.indicatorTitles[indicator] || indicator;
            
            document.querySelector('#graphPage .back-btn').textContent = langDict.backBtnText;
            document.querySelector('#graphPage .info-btn').textContent = langDict.infoBtnText;
            
            const dataSourceText = (indicator === 'SP500_MCAP') ? 'Source: https://ycharts.com' : 'Source: FRED';
            document.getElementById('graphDataSource').textContent = currentLanguage === 'ko' ? dataSourceText.replace('Source', '자료 출처') : dataSourceText;
            
            try {
                renderErrorMessage(currentLanguage === 'ko' ? "데이터를 불러오는 중..." : "Loading data...");
                
                if (indicator === 'YIELD_SPREAD') {
                    const [dgs10Data, dgs3moData, dgs2Data] = await Promise.all([
                        fetchAndCacheData('DGS10'),
                        fetchAndCacheData('DGS3MO'),
                        fetchAndCacheData('DGS2')
                    ]);

                    const dgs3moMap = new Map(dgs3moData.map(item => [item.date, item.value]));
                    const dgs2Map = new Map(dgs2Data.map(item => [item.date, item.value]));

                    const spread10y3m = [];
                    const spread10y2y = [];

                    dgs10Data.forEach(item10y => {
                        const date = item10y.date;
                        if (dgs3moMap.has(date)) {
                            spread10y3m.push({
                                x: date,
                                y: item10y.value - dgs3moMap.get(date)
                            });
                        }
                        if (dgs2Map.has(date)) {
                            spread10y2y.push({
                                x: date,
                                y: item10y.value - dgs2Map.get(date)
                            });
                        }
                    });
                    
                    const spread10y3mLabel = currentLanguage === 'ko' ? '10년물 - 3개월 채권 장단기 금리차' : '10-Year - 3-Month Yield Spread';
                    const spread10y2yLabel = currentLanguage === 'ko' ? '10년물 - 2년물 채권 장단기 금리차' : '10-Year - 2-Year Yield Spread';

                    currentGraphData = [
                        {
                            label: spread10y3mLabel,
                            data: spread10y3m,
                            borderColor: 'blue',
                            fill: false, tension: 0.1, pointRadius: 0
                        },
                        {
                            label: spread10y2yLabel,
                            data: spread10y2y,
                            borderColor: 'red',
                            fill: false, tension: 0.1, pointRadius: 0
                        }
                    ];
                } else if (spreadConfigs.hasOwnProperty(indicator)) {
                    const configs = spreadConfigs[indicator];
                    const dataPromises = configs.map(config => fetchAndCacheData(config.code));
                    const datasetsRaw = await Promise.all(dataPromises);

                    currentGraphData = datasetsRaw.map((data, index) => {
                        const config = configs[index];
                        return {
                            label: config.label,
                            borderColor: config.color,
                            data: data.map(item => ({ x: item.date, y: item.value })),
                            fill: false, tension: 0.1, pointRadius: 0
                        };
                    });
                } else {
                    let data = await fetchAndCacheData(indicator);
                    if (data.length === 0) {
                        const errorMsg = currentLanguage === 'ko' ? `'${langDict.indicatorTitles[indicator]}' 지표의 유효한 데이터가 없어요.` : `No valid data for '${langDict.indicatorTitles[indicator]}' indicator.`;
                        renderErrorMessage(errorMsg);
                        return;
                    }
                    let processedData = data.map(item => {
                        let value = item.value;
                        if (indicator === 'WALCL') value /= 1000;
                        else if (indicator === 'MMMFFAQ027S' || indicator === 'SP500_MCAP') value /= 1000000000;
                        return { x: item.date, y: value };
                    });

                    currentGraphData = [{
                        label: langDict.indicatorTitles[indicator] || indicator,
                        data: processedData,
                        borderColor: '#007bff',
                        backgroundColor: 'rgba(0, 123, 255, 0.1)',
                        fill: false, tension: 0.1, pointRadius: 0
                    }];
                }
                
                updateChart('All');

            } catch (error) {
                 const errorMsg = currentLanguage === 'ko' ? `'${langDict.indicatorTitles[indicator]}' 그래프를 그릴 수 없어요! 오류: ${error.message}` : `Cannot draw graph for '${langDict.indicatorTitles[indicator]}'! Error: ${error.message}`;
                renderErrorMessage(errorMsg);
            }
        }
        
        function renderChart(indicator, datasets) {
            const ctx = document.getElementById('myChart').getContext('2d');
            if (myChart) {
                myChart.destroy();
                myChart = null; 
            }
            myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: datasets
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { type: 'time', time: { unit: 'month', tooltipFormat: 'yyyy-MM-dd', displayFormats: { day: 'yyyy-MM-dd', month: 'yyyy-MM', year: 'yyyy' }}, title: { display: true, text: 'Date' }},
                        y: { title: { display: true, text: indicatorUnits[indicator] || 'Value', font: { weight: 'bold' }}, ticks: { callback: value => {
                            if (Math.abs(value) >= 1e12) return (value / 1e12) + 'T'; if (Math.abs(value) >= 1e9) return (value / 1e9) + 'B';
                            if (Math.abs(value) >= 1e6) return (value / 1e6) + 'M'; if (Math.abs(value) >= 1e3) return (value / 1e3) + 'K';
                            return value;
                        }}}
                    },
                    plugins: { legend: { display: true }, tooltip: { mode: 'index', intersect: false } },
                    onHover: (event, chartElement) => { event.native.target.style.cursor = chartElement.length ? 'grab' : 'default'; }
                }
            });
            const canvas = document.getElementById('myChart');
            canvas.onmousedown = startDragging; canvas.onmousemove = drag; canvas.onmouseup = stopDragging;
            canvas.onmouseleave = stopDragging; canvas.onwheel = zoomChart;
        }

        function updateChart(range) {
            if (!currentGraphData || currentGraphData.length === 0) return;
            
            let datasetsToShow = JSON.parse(JSON.stringify(currentGraphData)); 
            let hasData = false;

            if (range !== 'All') {
                const lastDate = new Date(Math.max(...datasetsToShow.flatMap(ds => ds.data.map(d => new Date(d.x).getTime()))));
                if (!isNaN(lastDate.getTime())) {
                    const cutoff = new Date(lastDate);
                    if (range === '1M') cutoff.setMonth(lastDate.getMonth() - 1);
                    else if (range === '6M') cutoff.setMonth(lastDate.getMonth() - 6);
                    else cutoff.setFullYear(lastDate.getFullYear() - { '1Y': 1, '5Y': 5, '10Y': 10 }[range]);
                    
                    datasetsToShow.forEach(ds => {
                        ds.data = ds.data.filter(item => new Date(item.x) >= cutoff);
                    });
                }
            }

            hasData = datasetsToShow.some(ds => ds.data.length > 0);

            if (hasData) {
                renderChart(currentIndicator, datasetsToShow);
            } else {
                const errorMsg = currentLanguage === 'ko' ? '해당 기간의 데이터가 없어요!' : 'No data available for this period!';
                renderErrorMessage(errorMsg);
            }
        }


        function renderErrorMessage(message) {
            const ctx = document.getElementById('myChart').getContext('2d');
            if (myChart) {
                myChart.destroy();
                myChart = null;
            }
            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
            ctx.fillStyle = '#666'; ctx.font = '16px Arial'; ctx.textAlign = 'center';
            ctx.fillText(message, ctx.canvas.width / 2, ctx.canvas.height / 2);
        }
        
        function showInfo() {
            showPage('infoPage');
            const langDict = translations[currentLanguage];
            const indicator = currentIndicator;
            const info = langDict.infoData[indicator] || { title: indicator, content: { 'Economic Meaning': 'No information available' } };
            
            document.querySelector('#infoPage .back-btn').textContent = langDict.backBtnText;
            document.getElementById('infoTitle').textContent = info.title || 'Unknown';
            document.getElementById('infoContent').innerHTML = Object.entries(info.content)
                .map(([key, value]) => {
                    let translatedKey = key;
                    if (currentLanguage === 'en') {
                       if (key === '경제적 의미') translatedKey = 'Economic Meaning';
                       else if (key === '왜 필요한 지표인가') translatedKey = 'Why is this indicator necessary?';
                       else if (key === '결론') translatedKey = 'Conclusion';
                    }
                    return `<h3>${translatedKey}</h3><p>${value}</p>`
                }).join('');
        }
        
        const getClosestData = (data, targetDate) => {
            if (!data || data.length === 0) return null;
            let closest = data[data.length - 1];
            let minDiff = Math.abs(new Date(closest.date) - targetDate);
            for (let i = data.length - 2; i >= 0; i--) {
                const currentData = data[i];
                const diff = Math.abs(new Date(currentData.date) - targetDate);
                if (diff < minDiff) {
                    minDiff = diff;
                    closest = currentData;
                } else { break; }
            }
            return closest;
        };

        async function updateLiquidityFlowAnimation() {
            stopLiquidityFlowAnimation();
            const langDict = translations[currentLanguage];
            const tooltipDict = langDict.tooltip;
            const displays = {
                tga: document.getElementById('tgaSlopeDisplay'), fed: document.getElementById('fedLiquidityDisplay'),
                mmf_fed: document.getElementById('mmfToRrpDisplay'), mmf_market: document.getElementById('mmfToMarketDisplay'),
                net_market_flow: document.getElementById('netMarketFlowDisplay')
            };
            const loadingText = currentLanguage === 'ko' ? "계산 중..." : "Calculating...";
            Object.values(displays).forEach(el => {
                if (el) { el.innerHTML = el.id !== 'netMarketFlowDisplay' ? loadingText : ""; el.style.color = "black"; }
            });
            const tooltips = {
                tga: document.getElementById('tga-tooltip-content'), fed: document.getElementById('fed-tooltip-content'),
                mmf_fed: document.getElementById('mmf-fed-tooltip-content'), mmf_market: document.getElementById('mmf-market-tooltip-content')
            };
            const indicators = ['WTREGEN', 'WALCL', 'RRPONTSYD', 'WRESBAL', 'MMMFFAQ027S', 'MMF2RRP', 'MMF2MARKET', 'MMF2GOVERNMENT'];
            const dataStore = {};
            try {
                const results = await Promise.all(indicators.map(indicator => fetchAndCacheData(indicator).catch(e => {
                    console.error(`Error fetching ${indicator}:`, e); return [];
                })));
                indicators.forEach((indicator, index) => { dataStore[indicator] = results[index]; });
            } catch (error) {
                console.error("Failed to load initial data for liquidity flow", error);
                const errorText = currentLanguage === 'ko' ? "데이터 오류" : "Data Error";
                Object.values(displays).forEach(el => { if (el) el.textContent = errorText; }); return;
            }
            let tgaDiff = null, fedLiquidityDiff = null, mmfToFedDiff = null, finalMmfToMarketDiff = null;
            let tgaLatestDate = null, fedLatestDate = null, mmfFedLatestDate = null, mmfMarketLatestDate = null;
            let mmfToMarketCombined = null, mmfAssetChange = null;
            const thirtyDaysAgo = (date) => { const newDate = new Date(date); newDate.setDate(newDate.getDate() - 30); return newDate; };

            if (['WTREGEN', 'WALCL', 'RRPONTSYD', 'WRESBAL'].every(i => dataStore[i] && dataStore[i].length > 0)) {
                const lastDates = ['WTREGEN', 'WALCL', 'RRPONTSYD', 'WRESBAL'].map(i => new Date(dataStore[i][dataStore[i].length - 1].date));
                const commonLatest = new Date(Math.min(...lastDates));
                tgaLatestDate = fedLatestDate = commonLatest.toISOString().split('T')[0];
                const pastDate = thirtyDaysAgo(commonLatest);
                const latest = {
                    tga: getClosestData(dataStore.WTREGEN, commonLatest)?.value, walcl: getClosestData(dataStore.WALCL, commonLatest)?.value,
                    rrp: getClosestData(dataStore.RRPONTSYD, commonLatest)?.value, resbal: getClosestData(dataStore.WRESBAL, commonLatest)?.value
                };
                const past = {
                    tga: getClosestData(dataStore.WTREGEN, pastDate)?.value, walcl: getClosestData(dataStore.WALCL, pastDate)?.value,
                    rrp: getClosestData(dataStore.RRPONTSYD, pastDate)?.value, resbal: getClosestData(dataStore.WRESBAL, pastDate)?.value
                };
                if (Object.values(latest).every(v => v != null) && Object.values(past).every(v => v != null)) {
                    tgaDiff = latest.tga - past.tga;
                    const walclDiff = (latest.walcl / 1000) - (past.walcl / 1000);
                    const rrpDiff = latest.rrp - past.rrp;
                    const resbalDiff = latest.resbal - past.resbal;
                    
                    fedLiquidityDiff = walclDiff - (tgaDiff + 2 * rrpDiff + 2 * resbalDiff);
                    
                    const fedAssetChange = walclDiff - tgaDiff - rrpDiff - resbalDiff;
                    const fedLiabilityChange = rrpDiff + resbalDiff;
                    const formatValue = (value) => `<span class="${value > 0 ? 'slope-positive' : 'slope-negative'}">${value > 0 ? '+' : ''}${value.toFixed(2)} B $/Month</span>`;
                    tooltips.fed.innerHTML = `${tooltipDict.fed.desc}
                        <p>${tooltipDict.fed.part1} ${formatValue(fedAssetChange)}</p><p>${tooltipDict.fed.part2} ${formatValue(fedLiabilityChange)}</p>
                        <button class="graph-btn" onclick="showGraph('WALCL')">${langDict.graphBtn}</button><span class="update-date">Update Date: ${fedLatestDate}</span>`;
                }
            }
            if (dataStore.MMF2RRP?.length > 0) {
                const latestDate = new Date(dataStore.MMF2RRP[dataStore.MMF2RRP.length - 1].date);
                mmfFedLatestDate = latestDate.toISOString().split('T')[0];
                const pastDate = thirtyDaysAgo(latestDate);
                const latestVal = getClosestData(dataStore.MMF2RRP, latestDate)?.value;
                const pastVal = getClosestData(dataStore.MMF2RRP, pastDate)?.value;
                if (latestVal != null && pastVal != null) { mmfToFedDiff = (latestVal - pastVal) / 1e9; }
            }
            if (dataStore.MMF2MARKET?.length > 0 && dataStore.MMF2GOVERNMENT?.length > 0) {
                 const latestDateM = new Date(dataStore.MMF2MARKET[dataStore.MMF2MARKET.length - 1].date); const pastDateM = thirtyDaysAgo(latestDateM);
                 const latestM = getClosestData(dataStore.MMF2MARKET, latestDateM)?.value; const pastM = getClosestData(dataStore.MMF2MARKET, pastDateM)?.value;
                 const latestDateG = new Date(dataStore.MMF2GOVERNMENT[dataStore.MMF2GOVERNMENT.length - 1].date); const pastDateG = thirtyDaysAgo(latestDateG);
                 const latestG = getClosestData(dataStore.MMF2GOVERNMENT, latestDateG)?.value; const pastG = getClosestData(dataStore.MMF2GOVERNMENT, pastDateG)?.value;
                 mmfMarketLatestDate = latestDateM.toISOString().split('T')[0];
                 if(latestM != null && pastM != null && latestG != null && pastG != null) { mmfToMarketCombined = ((latestM - pastM) + (latestG - pastG)) / 1e9; }
            }
            if (dataStore.MMMFFAQ027S?.length > 0) {
                const latestDate = new Date(dataStore.MMMFFAQ027S[dataStore.MMMFFAQ027S.length-1].date);
                const pastDate = thirtyDaysAgo(latestDate);
                const latestVal = getClosestData(dataStore.MMMFFAQ027S, latestDate)?.value; const pastVal = getClosestData(dataStore.MMMFFAQ027S, pastDate)?.value;
                if(latestVal != null && pastVal != null){ mmfAssetChange = (latestVal - pastVal) / 1e9; }
            }
            if (mmfToMarketCombined != null && mmfAssetChange != null) { finalMmfToMarketDiff = mmfToMarketCombined - mmfAssetChange; }
            
            if (tgaDiff != null) { const sign = tgaDiff > 0 ? '+' : ''; displays.tga.innerHTML = `${tooltipDict.tga.label}<br><span class="${tgaDiff > 0 ? 'slope-positive' : 'slope-negative'}">${sign}${tgaDiff.toFixed(2)} B $/Month</span>`;
                tooltips.tga.innerHTML = `${tooltipDict.tga.desc}
                <button class="graph-btn" onclick="showGraph('WTREGEN')">${langDict.graphBtn}</button><span class="update-date">Update Date: ${tgaLatestDate}</span>`;
            } else { displays.tga.textContent = langDict.errorText; }
            if (fedLiquidityDiff != null) { const sign = fedLiquidityDiff > 0 ? '+' : ''; displays.fed.innerHTML = `${tooltipDict.fed.label}<br><span class="${fedLiquidityDiff > 0 ? 'slope-positive' : 'slope-negative'}">${sign}${fedLiquidityDiff.toFixed(2)} B $/Month</span>`;
            } else { displays.fed.textContent = langDict.errorText; }
            if (mmfToFedDiff != null) { const sign = mmfToFedDiff > 0 ? '+' : ''; displays.mmf_fed.innerHTML = `${tooltipDict.mmf_fed.label}<br><span class="${mmfToFedDiff > 0 ? 'slope-positive' : 'slope-negative'}">${sign}${mmfToFedDiff.toFixed(2)} B $/Month</span>`;
                tooltips.mmf_fed.innerHTML = `${tooltipDict.mmf_fed.desc}
                <button class="graph-btn" onclick="showGraph('RRPONTSYD')">${langDict.graphBtn}</button><span class="update-date">Update Date: ${mmfFedLatestDate}</span>`;
            } else { displays.mmf_fed.textContent = langDict.errorText; }
            if (finalMmfToMarketDiff != null) { const sign = finalMmfToMarketDiff > 0 ? '+' : ''; displays.mmf_market.innerHTML = `${tooltipDict.mmf_market.label}<br><span class="${finalMmfToMarketDiff > 0 ? 'slope-positive' : 'slope-negative'}">${sign}${finalMmfToMarketDiff.toFixed(2)} B $/Month</span>`;
                const sign1 = mmfToMarketCombined > 0 ? '+' : ''; const sign2 = mmfAssetChange > 0 ? '+' : '';
                tooltips.mmf_market.innerHTML = `${tooltipDict.mmf_market.desc}
                <p>${tooltipDict.mmf_market.part1} <span class="${mmfToMarketCombined > 0 ? 'slope-positive' : 'slope-negative'}">${sign1}${mmfToMarketCombined.toFixed(2)} B $/Month</span></p>
                <p>${tooltipDict.mmf_market.part2} <span class="${mmfAssetChange > 0 ? 'slope-positive' : 'slope-negative'}">${sign2}${mmfAssetChange.toFixed(2)} B $/Month</span></p>
                <button class="graph-btn" onclick="showGraph('MMMFFAQ027S')">${langDict.graphBtn}</button><span class="update-date">Update Date: ${mmfMarketLatestDate}</span>`;
            } else { displays.mmf_market.textContent = langDict.errorText; }
            if (fedLiquidityDiff != null && tgaDiff != null && finalMmfToMarketDiff != null) {
                const netMarketFlow = fedLiquidityDiff - tgaDiff + finalMmfToMarketDiff;
                const sign = netMarketFlow > 0 ? '+' : '';
                displays.net_market_flow.innerHTML = `${langDict.netMarketFlowLabel}<span class="${netMarketFlow > 0 ? 'slope-positive' : 'slope-negative'}">${sign}${netMarketFlow.toFixed(2)} B $/Month</span></b>`;
            } else { displays.net_market_flow.textContent = ''; }
            
            const calculatedValues = [];
            if (tgaDiff != null) calculatedValues.push({ value: tgaDiff, animationClass: tgaDiff < 0 ? 'animated-dollar-from-government' : 'animated-dollar-to-government' });
            if (fedLiquidityDiff != null) calculatedValues.push({ value: fedLiquidityDiff, animationClass: fedLiquidityDiff < 0 ? 'animated-dollar-to-fed' : 'animated-dollar-to-market' });
            if (mmfToFedDiff != null) calculatedValues.push({ value: mmfToFedDiff, animationClass: mmfToFedDiff >= 0 ? 'animated-dollar-from-mmf-to-fed' : 'animated-dollar-from-fed-to-mmf' });
            if (finalMmfToMarketDiff != null) calculatedValues.push({ value: finalMmfToMarketDiff, animationClass: finalMmfToMarketDiff > 0 ? 'animated-dollar-from-mmf-to-market_parabolic' : 'animated-dollar-from-market-to-mmf_parabolic' });
            const rankedAnimations = calculatedValues.sort((a, b) => Math.abs(b.value) - Math.abs(a.value));
            const startAnimations = () => {
                rankedAnimations.forEach((task, index) => {
                    const factor = (4 - index) / 4.0; if (factor <= 0) return;
                    const size = BASE_DOLLAR_SIZE * factor; const duration = BASE_ANIMATION_DURATION / factor;
                    const spawnInterval = duration / NUM_DOLLAR_ANIMATIONS;
                    for (let i = 0; i < NUM_DOLLAR_ANIMATIONS; i++) {
                        const timeoutId = setTimeout(() => createAndAnimateDollar(task.animationClass, size, duration), i * spawnInterval);
                        dollarAnimationIntervals.push(timeoutId);
                    }
                });
            };
            if (rankedAnimations.length > 0) { startAnimations(); const resetIntervalId = setInterval(startAnimations, BASE_ANIMATION_DURATION); dollarAnimationIntervals.push(resetIntervalId); }
        }
        
        async function updateInterestRateFlowData() {
            const langDict = translations[currentLanguage];
            const tooltipDict = langDict.tooltip;
            const loadingText = currentLanguage === 'ko' ? "계산 중..." : "Calculating...";
            const errorText = currentLanguage === 'ko' ? "데이터 오류" : "Data Error";

            const indicatorConfigs = {
                sofr: { code: 'SOFR', displayEl: document.getElementById('sofrRateDisplay_interest'), tooltipEl: document.getElementById('sofr-rate-tooltip-content_interest') },
                effr: { code: 'FEDFUNDS', displayEl: document.getElementById('effrRateDisplay_interest'), tooltipEl: document.getElementById('effr-rate-tooltip-content_interest') },
                rrp_rate: { code: 'RRPONTSYAWARD', displayEl: document.getElementById('rrpRateDisplay_interest'), tooltipEl: document.getElementById('rrp-rate-tooltip-content_interest') },
                tb3ms: { code: 'DGS3MO', displayEl: document.getElementById('tb3msRateDisplay_interest'), tooltipEl: document.getElementById('tb3ms-tooltip-content_interest') },
                tb1yr: { code: 'DGS2', displayEl: document.getElementById('tb1yrRateDisplay_interest'), tooltipEl: document.getElementById('tb1yr-tooltip-content_interest') },
                tb10yr: { code: 'DGS10', displayEl: document.getElementById('tb10yrRateDisplay_interest'), tooltipEl: document.getElementById('tb10yr-tooltip-content_interest') },
                discount: { code: 'DPCREDIT', displayEl: document.getElementById('discountRateDisplay_interest'), tooltipEl: document.getElementById('discount-rate-tooltip-content_interest') }
            };
            const spreadDisplayEl = document.getElementById('sofrEffrSpreadDisplay_interest');
            const spreadTooltipEl = document.getElementById('sofr-effr-spread-tooltip-content_interest');

            Object.values(indicatorConfigs).forEach(({ displayEl }) => { if(displayEl) displayEl.textContent = loadingText; });
            if(spreadDisplayEl) spreadDisplayEl.textContent = loadingText;
            if(document.getElementById('netMarketFlowDisplay_interest')) document.getElementById('netMarketFlowDisplay_interest').textContent = '';

            const updateIndicator = async (key) => {
                const config = indicatorConfigs[key];
                try {
                    const data = await fetchAndCacheData(config.code);
                    if (data && data.length > 0) {
                        const { value, date } = data[data.length - 1];
                        config.displayEl.innerHTML = `${tooltipDict[key].label}<br><span style="color: black;">${value.toFixed(2)} %</span>`;
                        config.tooltipEl.innerHTML = `${tooltipDict[key].desc}<button class="graph-btn" onclick="showGraph('${config.code}')">${langDict.graphBtn}</button><span class="update-date">Update Date: ${date}</span>`;
                    } else { throw new Error("No data available"); }
                } catch (error) { console.error(`${config.code} data load failed:`, error.message); config.displayEl.textContent = errorText; }
            };

            await Promise.all(Object.keys(indicatorConfigs).map(key => updateIndicator(key)));

            try {
                const sofrData = dataCache.get('SOFR')?.data;
                const effrData = dataCache.get('FEDFUNDS')?.data;

                if (sofrData && sofrData.length > 0 && effrData && effrData.length > 0) {
                    const sofrLatest = sofrData[sofrData.length - 1];
                    const effrLatest = effrData[effrData.length - 1];
                    const spread = sofrLatest.value - effrLatest.value;
                    const latestDate = new Date(sofrLatest.date) > new Date(effrLatest.date) ? sofrLatest.date : effrLatest.date;
                    
                    const sign = spread > 0 ? '+' : '';
                    const colorClass = spread > 0 ? 'slope-positive' : 'slope-negative';

                    const labelText = window.innerWidth <= 600 ? tooltipDict.sofr_effr_spread.label_mobile : tooltipDict.sofr_effr_spread.label;
                    spreadDisplayEl.innerHTML = `${labelText}<br><span class="${colorClass}">${sign}${spread.toFixed(2)} %</span>`;
                    
                    spreadTooltipEl.innerHTML = `
                        ${tooltipDict.sofr_effr_spread.desc}
                        <button class="graph-btn" onclick="showGraph('SOFR_FEDFUNDS_SPREAD')">${langDict.graphBtn}</button>
                        <span class="update-date">Update Date: ${latestDate}</span>`;
                } else {
                    throw new Error("SOFR or EFFR data not in cache");
                }
            } catch (error) {
                console.error('SOFR EFFR spread calculation failed:', error);
                if(spreadDisplayEl) spreadDisplayEl.textContent = errorText;
            }
        }

        function createAndAnimateDollar(animationClass, size, duration) {
            const dollar = document.createElement('img');
            dollar.src = "./icon/dollar.jpg"; dollar.alt = "Dollar"; dollar.className = 'dollar-animated-object';
            dollar.style.width = `${size}px`; dollar.style.height = `${size}px`;
            dollar.style.setProperty('--animation-duration', `${duration / 1000}s`);
            dollar.classList.add(animationClass);
            
            const animationContainer = document.querySelector('#liquidityFlow .animation-container');
            if (animationContainer) {
                animationContainer.appendChild(dollar);
            }
            
            dollar.addEventListener('animationend', () => dollar.remove());
        }

        function stopLiquidityFlowAnimation() {
            dollarAnimationIntervals.forEach(id => { clearTimeout(id); clearInterval(id); });
            dollarAnimationIntervals = [];
            document.querySelectorAll('.dollar-animated-object').forEach(el => el.remove());
        }

        function startDragging(e) { if(myChart) { isDragging = true; startX = e.pageX - e.target.getBoundingClientRect().left; startScrollX = myChart.options.scales.x.min; e.target.style.cursor = 'grabbing'; }}
        function drag(e) {
            if (!isDragging || !myChart) return;
            e.preventDefault();
            const { x } = myChart.scales; const dataRange = x.max - x.min; const pixelRange = myChart.chartArea.right - myChart.chartArea.left;
            if (pixelRange <= 0) return;
            const dataOffset = ((e.pageX - e.target.getBoundingClientRect().left - startX) * 0.6 / pixelRange) * dataRange;
            let newMin = startScrollX - dataOffset; let newMax = newMin + dataRange;
            
            const allDates = currentGraphData.flatMap(ds => ds.data.map(d => new Date(d.x).getTime()));
            const minAllowed = Math.min(...allDates); 
            const maxAllowed = Math.max(...allDates);

            if (newMin < minAllowed) { newMin = minAllowed; newMax = newMin + dataRange; }
            if (newMax > maxAllowed) { newMax = maxAllowed; newMin = newMax - dataRange; }
            myChart.options.scales.x.min = newMin; myChart.options.scales.x.max = newMax; myChart.update('none');
        }
        function stopDragging(e) { if(isDragging) { isDragging = false; e.target.style.cursor = 'grab'; }}
        function zoomChart(e) {
            if (!myChart) return;
            e.preventDefault();
            const { x } = myChart.scales; const { min, max } = x; const range = max - min;
            const zoomFactor = e.deltaY < 0 ? 0.9 : 1.1; const mouseX = e.offsetX; const center = x.getValueForPixel(mouseX);
            const newMin = center - (center - min) * zoomFactor; const newMax = center + (max - center) * zoomFactor;
            
            const allDates = currentGraphData.flatMap(ds => ds.data.map(d => new Date(d.x).getTime()));
            const minAllowed = Math.min(...allDates); 
            const maxAllowed = Math.max(...allDates);
            
            if (newMin >= minAllowed && newMax <= maxAllowed) { myChart.options.scales.x.min = newMin; myChart.options.scales.x.max = newMax; myChart.update('none'); }
        }
        function goBackToGraph() { if (currentIndicator) { showPage('graphPage'); } }

    </script>
</body>
</html>